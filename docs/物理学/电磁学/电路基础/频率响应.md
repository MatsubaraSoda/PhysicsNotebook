# 频率响应

Frequency Response

## 传递函数

Transfer Function

The **transfer function** $\mathbf{H}(\omega)$ of a circuit is the frequency-dependent ratio of a phasor output $\mathbf{Y}(\omega)$ (an element voltage or current) to a phasor input $\mathbf{X}(\omega)$ (source voltage or current).

$$
\mathbf{H}(\omega) = \frac{\mathbf{Y}(\omega)}{\mathbf{X}(\omega)}
$$

The transfer function $\mathbf{H}(\omega)$ can be expressed in terms of its numerator polynomial $\mathbf{N}(\omega)$ and denominator polynomial $\mathbf{D}(\omega)$ as

$$
\mathbf{H}(\omega) = \frac{\mathbf{N}(\omega)}{\mathbf{D}(\omega)}
$$

The roots of $\mathbf{N}(\omega) = 0$ are called the *zeros* and usually represented by $j \omega = z_1, z_2, \dots$

Similarly, the roots of $\mathbf{D}(\omega) = 0$ are called the *poles* and usually represented by $j \omega = p_1, p_2, \dots$

>为了避免复数运算，有时会使用 $s$ 代替 $j \omega$。

## 分贝刻度

The Decibel Scale

在通信领域，增益 (gain) 使用贝尔 (bels) 衡量。历史上，贝尔用于衡量两个功率等级的比率，或者说是功率增益 G:

$$
G = \text{Number of bels} = \log_{10} \frac{P_2}{P_1}
$$

分贝 (decibels) 提供了一个量级更小的单位。1 分贝等于 1 贝尔的十分之一。其定义由下列公式给出：

$$
\boxed{
G_{\text{dB}} = 10 \log_{10} \frac{P_2}{P_1}
}
$$

<Img src="/物理学/电磁学/电路基础/fig-14-8.png" alt="Voltage-current relationships for a four-terminal network." maxHeight="200px" />

考虑如图所示的电路，分析其功率之比：

$$
\begin{aligned}
G_{\text{dB}} 
&= 10 \log_{10} \frac{P_2}{P_1}\\[8pt]
&= 10 \log_{10} \frac{V_2^2 / R_2}{V_1^2 / R_1}\\[8pt]
&= 10 \log_{10} \left( \frac{V_2}{V_1} \right)^2 - 10 \log_{10} \frac{R_2}{R_1}\\[8pt]
\end{aligned}
$$

在 $R_1 = R_2$ 的情况下（这是一个在比较电压时，经常被假设的条件），上述公式变为：

$$
\boxed{
G_{\text{dB}} = 20 \log_{10} \frac{V_2}{V_1}
}
$$

同理也有：

$$
G_{\text{dB}} = 20 \log_{10} \frac{I_2}{I_1}
$$

## 波特图

Bode Plots

传递函数的极坐标形式：

$$
\mathbf{H} = H \angle \phi = H e^{j \phi}
$$

对上述等式的两边求对数：

$$
\ln \mathbf{H} = \ln H + \ln e^{j \phi} = \ln H + j \phi
$$

在波特图中，横轴为 $\omega$，纵轴为 $H_{\text{dB}}$ 和 $\phi$。

$$
\boxed{
\phantom{\displaystyle\frac{1}{1}}
H_{\text{dB}} = 20 \log_{10} H
\phantom{\displaystyle\frac{1}{1}}
}
$$

$\mathbf{H}(\omega)$ 的标准形式 (standard form) 为：

$$
H(\omega) = \frac{K (j \omega)^{\pm 1} (1+j\omega / z_1) [1 + j 2 \zeta_1 \omega / \omega_k + (j \omega / \omega_k)^2]\cdots}{(1 + j \omega / p_1)[1 + j 2 \zeta_2 \omega / \omega_n + (j \omega / \omega_n)^2]\cdots}
$$

其中的“七种因式”：

1. 增益 K，一条水平直线
2. 原点零点 (a zero at the origin) $(j \omega)$
3. 原点极点 (a pole at the origin) $(j \omega)^{-1}$
4. 简单零点 (a simple zero) $(1 + j \omega / z_1)$
5. 简单极点 (a simple pole) $1 / (1 + j \omega / p_1)$
6. 二次零点 (a quadratic zero) $[1 + j 2 \zeta_1 \omega / \omega_k + (j \omega / \omega_k)^2]$
7. 二次极点 (a quadratic pole) $1 / [1 + j 2 \zeta_2 \omega / \omega_n + (j \omega / \omega_n)^2]$

### Constant term

<Img src="/物理学/电磁学/电路基础/fig-14-9.png" alt="Bode plots for gain K: (a) magnitude plot, (b) phase plot." maxHeight="200px" />

$$
\begin{aligned}
H_{\text{dB}} &= 20 \log_{10} \left| K \right|\\[6pt]
\phi &= \begin{cases}
0\degree, &K > 0\\[6pt]
\pm 180\degree, &K < 0
\end{cases}
\end{aligned}
$$

### Pole/zero at the origin

<Img src="/物理学/电磁学/电路基础/fig-14-10.png" alt="Bode plot for a zero ( jω) at the origin: (a) magnitude plot, (b) phase plot." maxHeight="200px" />

$$
\begin{aligned}
H_{\text{dB}} &= 20 \log_{10} \left| (j \omega)^N \right|\\[6pt]
&= 20 N \log_{10} \omega\\[6pt]
\phi &= 90 \degree N
\end{aligned}
$$

其中，$N \in \mathbb{Z}$。

### Simple pole/zero

<Img src="/物理学/电磁学/电路基础/fig-14-11.png" alt="Bode plots of zero (1 + jω∕z1): (a) magnitude plot, (b) phase plot." maxHeight="256px" />

**核心公式**

$$
H(\omega) = \left(1 + \frac{j \omega}{r_1}\right)^{N}
$$

其中 $N$ 是整数。$r_1$ 在 $N>0$ 时代表零点 $z_1$，在 $N<0$ 时代表极点 $p_1$。

**幅值**

$$
\begin{aligned}
H_{\text{dB}} &= 20 \log_{10} \left| \left(1 + \frac{j \omega}{r_1}\right)^N \right|\\[8pt]
&= 20 N \log_{10} \left| 1 + \frac{j \omega}{r_1} \right|\\[8pt]
H_{\text{dB}} &\approx 20 N \log_{10} 1 = 0, &\text{when }\omega \ll r_1\\[8pt]
H_{\text{dB}} &\approx 20 N \log_{10} \frac{\omega}{r_1}, &\text{when }\omega \gg r_1
\end{aligned}
$$

对于幅值，只有一个转折点 $\omega = r_1$：
- 当 $\omega < r_1$ 时，斜率为 0 dB/decade； $H_{\text{dB}} = 0\text{ dB}$；
- 当 $\omega = r_1$ 时，斜率从 0 变为 20 N dB/decade；
- 当 $\omega > r_1$ 时，斜率为 20 N dB/decade；

**相位**

$$
\phi = N \cdot \tan^{-1} \frac{\omega}{r_1} = 
\begin{cases}
0, \quad \omega = 0\\[6pt]
45 \degree N, \quad \omega = r_1\\[6pt]
90 \degree N, \quad \omega \to \infty
\end{cases}
$$

对于相位，有两个转折点 $\omega = 0.1\, r_1$ 和 $\omega = 10\, r_1$：
- 当 $\omega < 0.1\, r_1$ 时，$\phi = 0\degree$；
- 当 $\omega = 0.1\, r_1$ 时，斜率从 0° 变为 45° N/decade；
- 当 $\omega = r_1$ 时，$\phi = 45\degree N$；
- 当 $\omega = 10\, r_1$ 时，斜率从 45° N 变为 0° N/decade；
- 当 $\omega > 10\, r_1$ 时，$\phi = 90\degree N$；

### Quadratic pole/zero

<Img src="/物理学/电磁学/电路基础/fig-14-12.png" alt="Bode plots of quadratic pole [1 + j2ζω∕ωn − ω2∕ωn^2]−1: (a) magnitude plot, (b) phase plot." maxHeight="256px" />

**核心公式**

$$
H(\omega) = \left[ 1 + \frac{j 2 \zeta_2 \omega}{\omega_n} + \left(\frac{j \omega}{\omega_n}\right)^2 \right]^N\\[14pt]
$$

其中 $N$ 为整数，其中 $N > 0$ 表示零点，$N < 0$ 表示极点。$\omega_n$ 为自然频率，$\zeta_2$ 为阻尼比。

**幅值**

$$
\begin{aligned}
H_{\text{dB}}
&= 20 \log_{10} \left| \left[ 1 + \frac{j 2 \zeta_2 \omega}{\omega_n} + \left(\frac{j \omega}{\omega_n}\right)^2 \right]^N \right|\\[8pt]
&= 20 N \log_{10} \left| 1 + \frac{j 2 \zeta_2 \omega}{\omega_n} + \left(\frac{j \omega}{\omega_n}\right)^2 \right|\\[8pt]
H_{\text{dB}} &\approx 20 N \log_{10} 1 = 0, &\text{when }\omega \ll \omega_n\\[8pt]
H_{\text{dB}} &\approx 20 N \log_{10} \frac{\omega^2}{\omega_n^2} = 40 N \log_{10} \frac{\omega}{\omega_n}, &\text{when }\omega \gg \omega_n
\end{aligned}
$$

对于幅值，只有一个转折点 $\omega = \omega_n$：
- 当 $\omega < \omega_n$ 时，斜率为 0 dB/decade； $H_{\text{dB}} = 0\text{ dB}$；
- 当 $\omega = \omega_n$ 时，斜率从 0 变为 40 N dB/decade；
- 当 $\omega > \omega_n$ 时，斜率为 40 N dB/decade；

**相位**

$$
\phi = N \cdot \tan^{-1} \frac{2 \zeta_2 \omega / \omega_n}{1 - \omega^2 / \omega_n^2} = 
\begin{cases}
0, \quad \omega = 0\\[6pt]
90 \degree N, \quad \omega = \omega_n\\[6pt]
180 \degree N, \quad \omega \to \infty
\end{cases}
$$

对于相位，有两个转折点 $\omega = 0.1\, \omega_n$ 和 $\omega = 10\, \omega_n$：
- 当 $\omega < 0.1\, \omega_n$ 时，$\phi = 0\degree$；
- 当 $\omega = 0.1\, \omega_n$ 时，斜率从 0° 变为 90° N/decade；
- 当 $\omega = \omega_n$ 时，$\phi = 90\degree N$；
- 当 $\omega = 10\, \omega_n$ 时，斜率从 90° N/decade 变为 0° N/decade；
- 当 $\omega > 10\, \omega_n$ 时，$\phi = 180\degree N$；

### Summary

<Img src="/物理学/电磁学/电路基础/table-14-3.svg" alt="Summary of Bode straight-line magnitude and phase plots." maxHeight="auto" />

## 串联谐振

Series Resonance

$$
\mathbf{Z} = \mathbf{H}(\omega) = \frac{\mathbf{V}_s}{\mathbf{I}} = R + j \omega L + \frac{1}{j \omega C}
$$

$$
\mathbf{Z} = R + j \left( \omega L - \frac{1}{\omega C} \right)
$$

$$
\text{Im}(\mathbf{Z}) = \omega L - \frac{1}{\omega C} = 0
$$

$$
\omega_0 L = \frac{1}{\omega_0 C}
$$

$$
\boxed{
\omega_0 = \frac{1}{\sqrt{LC}} \text{rad/s}
}
$$

$$
f_0 = \frac{1}{2 \pi \sqrt{LC}} \text{Hz}
$$

$$
I = | \mathbf{I} | = \frac{V_m}{\sqrt{R^2 + (\omega L - \displaystyle\frac{1}{\omega C})^2}}\\[26pt]
$$

$$
P(\omega) = \frac{1}{2} I^2 R
$$

$$
P(\omega_0) = \frac{1}{2} \frac{V_m^2}{R}
$$

$$
P(\omega_1) = P(\omega_2) = \frac{1}{2} P(\omega_0) = \frac{V_m^2}{4R}
$$

$$
\sqrt{R^2 + \left( \omega L - \displaystyle\frac{1}{\omega C} \right)^2} = \sqrt{2} R
$$

$$
\boxed{
\begin{aligned}
\omega_1 &= -\frac{R}{2 L} + \sqrt{\left(\frac{R}{2 L}\right)^2 + \frac{1}{L C}}\\[8pt]
\omega_2 &= \frac{R}{2 L} + \sqrt{\left(\frac{R}{2 L}\right)^2 + \frac{1}{L C}}
\end{aligned}
}
$$

$$
\omega_0 = \sqrt{\omega_1 \omega_2}
$$

$$
B = \omega_2 - \omega_1
$$

$$
Q = 2\pi \cdot \frac{\text{Peak energy stored in the circuit}}{\text{Energy dissipated by the circuit in one period at resonance}}
$$

$$
Q = 2\pi \frac{\displaystyle\frac{1}{2} L I^2}{\displaystyle\frac{1}{2} I^2 R \displaystyle\frac{1}{f_0}} = \frac{2\pi f_0 L}{R}
$$

$$
\boxed{
Q = \frac{\omega_0 L}{R} = \frac{1}{\omega_0 C R}
}
$$

$$
\boxed{
B = \frac{R}{L} = \omega_0^2 R C = \frac{\omega_0}{Q}
}
$$

## 并联谐振

Parallel Resonance

$$
\mathbf{Y} = \mathbf{H}(\omega) = \frac{\mathbf{I}}{\mathbf{V}} = \frac{1}{R} + j \omega C + \frac{1}{j \omega L}
$$

$$
\mathbf{Y} = \frac{1}{R} + j \left( \omega C - \frac{1}{\omega L} \right)
$$

$$
\omega C - \frac{1}{\omega L} = 0
$$

$$
\boxed{
\omega_0 = \frac{1}{\sqrt{LC}} \text{rad/s}
}
$$

$$
\boxed{
\begin{aligned}
\omega_1 = -\frac{1}{2 R C} + \sqrt{\left(\frac{1}{2 R C}\right)^2 + \frac{1}{L C}}\\[8pt]
\omega_2 = \frac{1}{2 R C} + \sqrt{\left(\frac{1}{2 R C}\right)^2 + \frac{1}{L C}}
\end{aligned}
}
$$

$$
\boxed{
B = \omega_2 - \omega_1 = \frac{1}{R C}
}
$$

$$
Q = \frac{\omega_0}{B} = \omega_0 R C = \frac{R}{\omega_0 L}
$$


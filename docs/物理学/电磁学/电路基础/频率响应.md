# 频率响应

Frequency Response

## 传递函数

Transfer Function

The **transfer function** $\mathbf{H}(\omega)$ of a circuit is the frequency-dependent ratio of a phasor output $\mathbf{Y}(\omega)$ (an element voltage or current) to a phasor input $\mathbf{X}(\omega)$ (source voltage or current).

$$
\mathbf{H}(\omega) = \frac{\mathbf{Y}(\omega)}{\mathbf{X}(\omega)}
$$

The transfer function $\mathbf{H}(\omega)$ can be expressed in terms of its numerator polynomial $\mathbf{N}(\omega)$ and denominator polynomial $\mathbf{D}(\omega)$ as

$$
\mathbf{H}(\omega) = \frac{\mathbf{N}(\omega)}{\mathbf{D}(\omega)}
$$

The roots of $\mathbf{N}(\omega) = 0$ are called the *zeros* and usually represented by $j \omega = z_1, z_2, \dots$

Similarly, the roots of $\mathbf{D}(\omega) = 0$ are called the *poles* and usually represented by $j \omega = p_1, p_2, \dots$

>为了避免复数运算，有时会使用 $s$ 代替 $j \omega$。

## 分贝刻度

The Decibel Scale

在通信领域，增益 (gain) 使用贝尔 (bels) 衡量。历史上，贝尔用于衡量两个功率等级的比率，或者说是功率增益 G:

$$
G = \text{Number of bels} = \log_{10} \frac{P_2}{P_1}
$$

分贝 (decibels) 提供了一个量级更小的单位。1 分贝等于 1 贝尔的十分之一。其定义由下列公式给出：

$$
\boxed{
G_{\text{dB}} = 10 \log_{10} \frac{P_2}{P_1}
}
$$

<Img src="/物理学/电磁学/电路基础/fig-14-8.png" alt="Voltage-current relationships for a four-terminal network." maxHeight="200px" />

考虑如图所示的电路，分析其功率之比：

$$
\begin{aligned}
G_{\text{dB}} 
&= 10 \log_{10} \frac{P_2}{P_1}\\[8pt]
&= 10 \log_{10} \frac{V_2^2 / R_2}{V_1^2 / R_1}\\[8pt]
&= 10 \log_{10} \left( \frac{V_2}{V_1} \right)^2 - 10 \log_{10} \frac{R_2}{R_1}\\[8pt]
\end{aligned}
$$

在 $R_1 = R_2$ 的情况下（这是一个在比较电压时，经常被假设的条件），上述公式变为：

$$
\boxed{
G_{\text{dB}} = 20 \log_{10} \frac{V_2}{V_1}
}
$$

同理也有：

$$
G_{\text{dB}} = 20 \log_{10} \frac{I_2}{I_1}
$$

## 波特图

Bode Plots

传递函数的极坐标形式：

$$
\mathbf{H} = H \angle \phi = H e^{j \phi}
$$

对上述等式的两边求对数：

$$
\ln \mathbf{H} = \ln H + \ln e^{j \phi} = \ln H + j \phi
$$

在波特图中，横轴为 $\omega$，纵轴为 $H_{\text{dB}}$ 和 $\phi$。

$$
\boxed{
\phantom{\displaystyle\frac{1}{1}}
H_{\text{dB}} = 20 \log_{10} H
\phantom{\displaystyle\frac{1}{1}}
}
$$

$\mathbf{H}(\omega)$ 的标准形式 (standard form) 为：

$$
H(\omega) = \frac{K (j \omega)^{\pm 1} (1+j\omega / z_1) [1 + j 2 \zeta_1 \omega / \omega_k + (j \omega / \omega_k)^2]\cdots}{(1 + j \omega / p_1)[1 + j 2 \zeta_2 \omega / \omega_n + (j \omega / \omega_n)^2]\cdots}
$$

其中的“七种因式”：

1. 增益 K，一条水平直线
2. 原点零点 (a zero at the origin) $(j \omega)$
3. 原点极点 (a pole at the origin) $(j \omega)^{-1}$
4. 简单零点 (a simple zero) $(1 + j \omega / z_1)$
5. 简单极点 (a simple pole) $1 / (1 + j \omega / p_1)$
6. 二次零点 (a quadratic zero) $[1 + j 2 \zeta_1 \omega / \omega_k + (j \omega / \omega_k)^2]$
7. 二次极点 (a quadratic pole) $1 / [1 + j 2 \zeta_2 \omega / \omega_n + (j \omega / \omega_n)^2]$

### Constant term

<Img src="/物理学/电磁学/电路基础/fig-14-9.png" alt="Bode plots for gain K: (a) magnitude plot, (b) phase plot." maxHeight="200px" />

$$
\begin{aligned}
H_{\text{dB}} &= 20 \log_{10} \left| K \right|\\[6pt]
\phi &= \begin{cases}
0\degree, &K > 0\\[6pt]
\pm 180\degree, &K < 0
\end{cases}
\end{aligned}
$$

### Pole/zero at the origin

<Img src="/物理学/电磁学/电路基础/fig-14-10.png" alt="Bode plot for a zero ( jω) at the origin: (a) magnitude plot, (b) phase plot." maxHeight="200px" />

$$
\begin{aligned}
H_{\text{dB}} &= 20 \log_{10} \left| (j \omega)^N \right|\\[6pt]
&= 20 N \log_{10} \omega\\[6pt]
\phi &= 90 \degree N
\end{aligned}
$$

其中，$N \in \mathbb{Z}$。

### Simple pole/zero

<Img src="/物理学/电磁学/电路基础/fig-14-11.png" alt="Bode plots of zero (1 + jω∕z1): (a) magnitude plot, (b) phase plot." maxHeight="256px" />

**核心公式**

$$
H(\omega) = \left(1 + \frac{j \omega}{r_1}\right)^{N}
$$

其中 $N$ 是整数。$r_1$ 在 $N>0$ 时代表零点 $z_1$，在 $N<0$ 时代表极点 $p_1$。

**幅值**

$$
\begin{aligned}
H_{\text{dB}} &= 20 \log_{10} \left| \left(1 + \frac{j \omega}{r_1}\right)^N \right|\\[8pt]
&= 20 N \log_{10} \left| 1 + \frac{j \omega}{r_1} \right|\\[8pt]
H_{\text{dB}} &\approx 20 N \log_{10} 1 = 0, &\text{when }\omega \ll r_1\\[8pt]
H_{\text{dB}} &\approx 20 N \log_{10} \frac{\omega}{r_1}, &\text{when }\omega \gg r_1
\end{aligned}
$$

对于幅值，只有一个转折点 $\omega = r_1$：
- 当 $\omega < r_1$ 时，斜率为 0 dB/decade； $H_{\text{dB}} = 0\text{ dB}$；
- 当 $\omega = r_1$ 时，斜率从 0 变为 20 N dB/decade；
- 当 $\omega > r_1$ 时，斜率为 20 N dB/decade；

**相位**

$$
\phi = N \cdot \tan^{-1} \frac{\omega}{r_1} = 
\begin{cases}
0, \quad \omega = 0\\[6pt]
45 \degree N, \quad \omega = r_1\\[6pt]
90 \degree N, \quad \omega \to \infty
\end{cases}
$$

对于相位，有两个转折点 $\omega = 0.1\, r_1$ 和 $\omega = 10\, r_1$：
- 当 $\omega < 0.1\, r_1$ 时，$\phi = 0\degree$；
- 当 $\omega = 0.1\, r_1$ 时，斜率从 0° 变为 45° N/decade；
- 当 $\omega = r_1$ 时，$\phi = 45\degree N$；
- 当 $\omega = 10\, r_1$ 时，斜率从 45° N 变为 0° N/decade；
- 当 $\omega > 10\, r_1$ 时，$\phi = 90\degree N$；

### Quadratic pole/zero

<Img src="/物理学/电磁学/电路基础/fig-14-12.png" alt="Bode plots of quadratic pole [1 + j2ζω∕ωn − ω2∕ωn^2]−1: (a) magnitude plot, (b) phase plot." maxHeight="256px" />

**核心公式**

$$
H(\omega) = \left[ 1 + \frac{j 2 \zeta_2 \omega}{\omega_n} + \left(\frac{j \omega}{\omega_n}\right)^2 \right]^N\\[14pt]
$$

其中 $N$ 为整数，其中 $N > 0$ 表示零点，$N < 0$ 表示极点。$\omega_n$ 为自然频率，$\zeta_2$ 为阻尼比。

**幅值**

$$
\begin{aligned}
H_{\text{dB}}
&= 20 \log_{10} \left| \left[ 1 + \frac{j 2 \zeta_2 \omega}{\omega_n} + \left(\frac{j \omega}{\omega_n}\right)^2 \right]^N \right|\\[8pt]
&= 20 N \log_{10} \left| 1 + \frac{j 2 \zeta_2 \omega}{\omega_n} + \left(\frac{j \omega}{\omega_n}\right)^2 \right|\\[8pt]
H_{\text{dB}} &\approx 20 N \log_{10} 1 = 0, &\text{when }\omega \ll \omega_n\\[8pt]
H_{\text{dB}} &\approx 20 N \log_{10} \frac{\omega^2}{\omega_n^2} = 40 N \log_{10} \frac{\omega}{\omega_n}, &\text{when }\omega \gg \omega_n
\end{aligned}
$$

对于幅值，只有一个转折点 $\omega = \omega_n$：
- 当 $\omega < \omega_n$ 时，斜率为 0 dB/decade； $H_{\text{dB}} = 0\text{ dB}$；
- 当 $\omega = \omega_n$ 时，斜率从 0 变为 40 N dB/decade；
- 当 $\omega > \omega_n$ 时，斜率为 40 N dB/decade；

**相位**

$$
\phi = N \cdot \tan^{-1} \frac{2 \zeta_2 \omega / \omega_n}{1 - \omega^2 / \omega_n^2} = 
\begin{cases}
0, \quad \omega = 0\\[6pt]
90 \degree N, \quad \omega = \omega_n\\[6pt]
180 \degree N, \quad \omega \to \infty
\end{cases}
$$

对于相位，有两个转折点 $\omega = 0.1\, \omega_n$ 和 $\omega = 10\, \omega_n$：
- 当 $\omega < 0.1\, \omega_n$ 时，$\phi = 0\degree$；
- 当 $\omega = 0.1\, \omega_n$ 时，斜率从 0° 变为 90° N/decade；
- 当 $\omega = \omega_n$ 时，$\phi = 90\degree N$；
- 当 $\omega = 10\, \omega_n$ 时，斜率从 90° N/decade 变为 0° N/decade；
- 当 $\omega > 10\, \omega_n$ 时，$\phi = 180\degree N$；

### Summary

<Img src="/物理学/电磁学/电路基础/table-14-3.svg" alt="Summary of Bode straight-line magnitude and phase plots." maxHeight="auto" width="800px" />

## 谐振

### 串联谐振

Series Resonance

<Img src="/物理学/电磁学/电路基础/fig-14-21.png" alt="The series resonant circuit." maxHeight="200px" />

如图。

输入阻抗为

$$
\mathbf{Z} = \mathbf{H}(\omega) = \frac{\mathbf{V}_s}{\mathbf{I}} = R + j \omega L + \frac{1}{j \omega C}
$$

或

$$
\mathbf{Z} = R + j \left( \omega L - \frac{1}{\omega C} \right)
$$

当传递函数的虚部为零时，即产生谐振

$$
\text{Im}(\mathbf{Z}) = \omega L - \frac{1}{\omega C} = 0
$$

满足此条件的 $\omega$ 称为谐振频率 $\omega_0$。因此

$$
\omega_0 L = \frac{1}{\omega_0 C}
$$

或

$$
\boxed{
\omega_0 = \frac{1}{\sqrt{LC}} \text{rad/s}
}
$$

由于 $\omega_0 = 2 \pi f_0$，所以

$$
f_0 = \frac{1}{2 \pi \sqrt{LC}} \text{Hz}
$$

注意，谐振电路意味着
1. 阻抗时纯电阻，因此 Z = R。换句话说，LC 串联组合的作用相当于短路，全部电压都施加在 R 上。
2. 电压 V<sub>s</sub> 和电流 I 同相，因此功率系数为 1。
3. 传递函数 H(ω) = Z(ω) 的幅值达到最小值。
4. 电感电压和电容电压可能远远大于源电压。

<Img src="/物理学/电磁学/电路基础/fig-14-22.png" alt="The current amplitude versus frequency for the series resonant circuit of Fig. 14.21." maxHeight="256px" />

如图。

电路的电流幅值 I 的频率响应为 V<sub>s</sub> / R

$$
I = | \mathbf{I} | = \frac{V_m}{\sqrt{R^2 + (\omega L - \displaystyle\frac{1}{\omega C})^2}}\\[26pt]
$$

当 $\omega = \omega_0$ 时，电流幅值达到最大值 V<sub>m</sub> / R。此时功率为

$$
P(\omega_0) = \frac{1}{2} \frac{V_m^2}{R}
$$

$\omega_1$ 和 $\omega_2$ 是电流幅值下降到最大值的一半时的频率。此时

$$
P(\omega_1) = P(\omega_2) = \frac{1}{2} P(\omega_0) = \frac{V_m^2}{4R}
$$

因此，$\omega_1$ 和 $\omega_2$ 也被称作半功率频率 (half-power frequencies)。注意到示意图中，仅在频率轴（横轴）为对数坐标时才显示出对称性。

为了求解半功率频率，令 $Z = \sqrt{2} R$ 即可

$$
\sqrt{R^2 + \left( \omega L - \displaystyle\frac{1}{\omega C} \right)^2} = \sqrt{2} R
$$

解得

$$
\boxed{
\begin{aligned}
\omega_1 &= -\frac{R}{2 L} + \sqrt{\left(\frac{R}{2 L}\right)^2 + \frac{1}{L C}}\\[8pt]
\omega_2 &= \frac{R}{2 L} + \sqrt{\left(\frac{R}{2 L}\right)^2 + \frac{1}{L C}}
\end{aligned}
}
$$

将半功率频率与谐振频率联系起来

$$
\omega_0 = \sqrt{\omega_1 \omega_2}
$$

带宽 (bandwidth) 被定义为半功率频率之间的差值

$$
B = \omega_2 - \omega_1
$$

>严格来说，上述定义是半功率带宽。

<Img src="/物理学/电磁学/电路基础/fig-14-23.png" alt="The higher the circuit Q, the smaller the bandwidth." maxHeight="500px" />

谐振电路中谐振的“尖锐程度”通过品质因数 (quality factor) Q 来定量测量。在谐振时，电路中的无功能量在电感和电容之间振荡。品质因数关联了存储的峰值能量与电路在每个振荡周期中消耗的能量

$$
Q = 2\pi \cdot \frac{\text{Peak energy stored in the circuit}}{\text{Energy dissipated by the circuit in one period at resonance}}
$$

在串联 RLC 电路中，上述公式变为

$$
Q = 2\pi \frac{\displaystyle\frac{1}{2} L I^2}{\displaystyle\frac{1}{2} I^2 R \displaystyle\frac{1}{f_0}} = \frac{2\pi f_0 L}{R}
$$

或

$$
\boxed{
Q = \frac{\omega_0 L}{R} = \frac{1}{\omega_0 C R}
}
$$

注意，品质因数是无量纲的。带宽 B 与品质因数 Q 的关系为

$$
\boxed{
B = \frac{R}{L} = \omega_0^2 R C = \frac{\omega_0}{Q}
}
$$

补充，谐振电路被设计为在其谐振频率或附近工作。当其品质因数等于或大于 10 时，称其为高 Q 电路。对于高 Q 电路 (Q &geq; 10)，半功率频率在所有实际应用中都围绕谐振频率对称，并且可以近似为

$$
\omega_1 \approx \omega_0 - \frac{B}{2},\quad \omega_2 \approx \omega_0 + \frac{B}{2}

$$

### 并联谐振

Parallel Resonance

<Img src="/物理学/电磁学/电路基础/fig-14-25.png" alt="The parallel resonant circuit." maxHeight="150px" />

<Img src="/物理学/电磁学/电路基础/fig-14-26.png" alt="The current amplitude versus frequency for the series resonant circuit of Fig. 14.25." maxHeight="256px" />

由于并联 RLC 电路和串联 RLC 电路是对偶的，因此可以避免不必要的重复计算。并联 RLC 电路的输入导纳为

$$
\mathbf{Y} = \mathbf{H}(\omega) = \frac{\mathbf{I}}{\mathbf{V}} = \frac{1}{R} + j \omega C + \frac{1}{j \omega L}
$$

或

$$
\mathbf{Y} = \frac{1}{R} + j \left( \omega C - \frac{1}{\omega L} \right)
$$

当 Y 的虚部为零时，发生谐振

$$
\omega C - \frac{1}{\omega L} = 0
$$

或

$$
\boxed{
\omega_0 = \frac{1}{\sqrt{LC}} \text{rad/s}
}
$$

注意，在谐振时，并联 LC 组合的作用类似于开路，因此全部电流都流过 R。此外，在谐振时，电感和电容电流可能远大于源电流。

利用对偶性，使用 1/R、C、L 分别替换串联电路中的 R、L、C 即可得到并联电路的相应公式

$$
\boxed{
\begin{aligned}
\omega_1 &= -\frac{1}{2 R C} + \sqrt{\left(\frac{1}{2 R C}\right)^2 + \frac{1}{L C}}\\[8pt]
\omega_2 &= \frac{1}{2 R C} + \sqrt{\left(\frac{1}{2 R C}\right)^2 + \frac{1}{L C}}
\end{aligned}
}
$$

$$
\boxed{
B = \omega_2 - \omega_1 = \frac{1}{R C}
}
$$

$$
\boxed{
Q = \frac{\omega_0}{B} = \omega_0 R C = \frac{R}{\omega_0 L}
}
$$

同样，对于高 Q 电路

$$
\omega_1 \approx \omega_0 - \frac{B}{2},\quad \omega_2 \approx \omega_0 + \frac{B}{2}
$$

### Summary

<Img src="/物理学/电磁学/电路基础/table-14-4.svg" alt="Summary of series and parallel resonant circuits." maxHeight="auto" width="800px" />

## 滤波器

滤波器的四种理想频率响应图

<Img src="/物理学/电磁学/电路基础/fig-14-30.png" alt="Ideal frequency response of four types of filters: (a) low-pass filter, (b) high-pass filter, (c) band-pass filter, (d) band-stop filter." maxHeight="200px" />

### 无源

Passive Filters

#### 低通

<Img src="/物理学/电磁学/电路基础/fig-14-31.png" alt="A low-pass filter." maxHeight="200px" />

如图所示的 RC 串联电路即可实现最简单的低通滤波器。由输出电压和输入电压之比得到传递函数

$$
\mathbf{H}(\omega) = \frac{\mathbf{V}_o}{\mathbf{V}_i} = \frac{1 / j \omega C}{R + 1 / j \omega C} = \frac{1}{1 + j \omega R C}
$$

其满足 $\mathbf{H}(0) = 1$ 和 $\mathbf{H}(\infty) = 0$。

<Img src="/物理学/电磁学/电路基础/fig-14-32.png" alt="Ideal and actual frequency response of a low-pass filter." maxHeight="300px" />

如图，半功率频率 (half-power frequency) 等于波特图中的转折频率 (corner frequency)，但在滤波器的语境中，它们通常被称为截止频率 (cutoff frequency)。它是通过将 $H(\omega)$ 的幅值设置为 $\frac{1}{\sqrt{2}}$ 来求解得到的。

$$
H(\omega_c) = \frac{1}{\sqrt{1 + \omega_c^2 R^2 C^2}} = \frac{1}{\sqrt{2}}\\[16pt]
$$

或

$$
\omega_c = \frac{1}{R C}
$$

>低通滤波器也能通过 RL 电路实现。同时，低通滤波器还有更多种实现方式。

#### 高通

<Img src="/物理学/电磁学/电路基础/fig-14-33.png" alt="A high-pass filter." maxHeight="200px" />

复用低通滤波器的示例电路，这次的输出电压为电阻 R 两端的电压。因此传递函数为

$$
\mathbf{H}(\omega) = \frac{\mathbf{V}_o}{\mathbf{V}_i} = \frac{R}{R + 1 / j \omega C} = \frac{j \omega R C}{1 + j \omega R C}
$$

其满足 $\mathbf{H}(0) = 0$ 和 $\mathbf{H}(\infty) = 1$。

<Img src="/物理学/电磁学/电路基础/fig-14-34.png" alt="Ideal and actual frequency response of a high-pass filter." maxHeight="300px" />

同理，它的截止频率为

$$
\omega_c = \frac{1}{R C}
$$

>高通滤波器也能通过 RC 电路实现。同时，高通滤波器还有更多种实现方式。

#### 带通

<Img src="/物理学/电磁学/电路基础/fig-14-35.png" alt="A band-pass filter." maxHeight="200px" />

如图。这个 RLC 串联响应电路可以实现带通滤波器。其传递函数为

$$
\mathbf{H}(\omega) = \frac{\mathbf{V}_o}{\mathbf{V}_i} = \frac{R}{R + j (\omega L - \frac{1}{\omega C})}
$$

其满足 $\mathbf{H}(0) = 0$ 和 $\mathbf{H}(\infty) = 0$。

<Img src="/物理学/电磁学/电路基础/fig-14-36.png" alt="Ideal and actual frequency response of a band-pass filter." maxHeight="300px" />

这个带通滤波器允许一个以 &omega;<sub>0</sub> 为中心的频率范围 (&omega;<sub>1</sub>, &omega;<sub>2</sub>) 的信号通过

$$
\omega_0 = \frac{1}{\sqrt{LC}}
$$

> 实际上，这个带通滤波器的电路模型在之前的[串联谐振](#串联谐振)中已经介绍过了。其半功率频率、带宽和品质因数参考谐振电路的公式即可。

#### 带阻

<Img src="/物理学/电磁学/电路基础/fig-14-37.png" alt="A band-stop filter." maxHeight="200px" />

如图，传递函数为

$$
\mathbf{H}(\omega) = \frac{\mathbf{V}_o}{\mathbf{V}_i} = \frac{j(\omega L - 1 / \omega C)}{R + j(\omega L - 1 / \omega C)}
$$

其满足 $\mathbf{H}(0) = 1$ 和 $\mathbf{H}(\infty) = 1$。

<Img src="/物理学/电磁学/电路基础/fig-14-38.png" alt="Ideal and actual frequency response of a band-stop filter." maxHeight="300px" />

抑制频率 (the frequency of rejection) 为

$$
\omega_0 = \frac{1}{\sqrt{LC}}
$$

#### Conclusion

1. 无源滤波器 (passive filters) 的最大增益为 1 (unity)。要产生大于 1 的增益，应该使用有源滤波器 (active filters)。
2. 还有很多其他更复杂的拓扑结构 (topologies) 也能实现本文讨论的四种滤波器。
3. 本文讨论的滤波器都是极其简单的。许多其他的滤波器具有更尖锐 (sharper) 和更复杂 (complex) 的频率响应。

### 有源

Active Filters

<Img src="/物理学/电磁学/电路基础/fig-14-41.png" alt="A general first-order active filter." maxHeight="200px" />

#### 一阶低通

<Img src="/物理学/电磁学/电路基础/fig-14-42.png" alt="Active first-order low-pass filter." maxHeight="256px" />

如上图所示，这是一个典型的有源低通滤波器。其传递函数为

$$
\mathbf{H}(\omega) = \frac{\mathbf{V}_o}{\mathbf{V}_i} = - \frac{\mathbf{Z}_f}{\mathbf{Z}_i}
$$

其中，

$$
\mathbf{Z}_i = R_i,\quad \mathbf{Z}_f = R_f \parallel \frac{1}{j \omega C_f} = \frac{R_f}{1 + j \omega R_f C_f}
$$

于是，

$$
\mathbf{H}(\omega) = - \frac{\frac{R_f}{1 + j \omega R_f C_f}}{R_i} = - \frac{R_f}{R_i}\cdot \frac{1}{1 + j \omega R_f C_f}
$$

并且，$\mathbf{H}(0) = - R_f / R_i$ 和 $\mathbf{H}(\infty) = 0$。

该滤波器的简单极点 $p_1$ 位于 $s = -\frac{1}{R_f C_f}$。

其截止频率 $\omega_c$ 由该极点的位置决定，也就是

$$
\omega_c = |p_1| = \frac{1}{R_f C_f}
$$

注意到，截止频率 $\omega_c$ 由电阻 $R_f$ 和电容 $C_f$ 决定，与电阻 $R_i$ 无关。这意味着如果有需要，可以将多个具有不同输入电阻 $R_i$ 的输入信号相加，而每个输入的截止频率保持相同。

#### 一阶高通

<Img src="/物理学/电磁学/电路基础/fig-14-43.png" alt="Active first-order high-pass filter." maxHeight="200px" />

如上图所示，这是一个典型的有源高通滤波器。其传递函数为

$$
\mathbf{H}(\omega) = \frac{\mathbf{V}_o}{\mathbf{V}_i} = - \frac{\mathbf{Z}_f}{\mathbf{Z}_i}
$$

其中，

$$
\mathbf{Z}_i = R_i + 1 / j \omega C_i, \quad \mathbf{Z}_f = R_f
$$

于是，

$$
\mathbf{H}(\omega) = - \frac{R_f}{R_i + 1 / j \omega C_i} = - \frac{j \omega R_f C_i}{1 + j \omega R_i C_i}
$$

并且，$\mathbf{H}(0) = 0$ 和 $\mathbf{H}(\infty) = - R_f / R_i$。

该滤波器的简单极点 $p_1$ 位于 $s = -\frac{1}{R_i C_i}$。

其截止频率 $\omega_c$ 为

$$
\omega_c = \frac{1}{R_i C_i}
$$

#### 带通

<Img src="/物理学/电磁学/电路基础/fig-14-44.png" alt="Active band-pass filter: (a) block diagram, (b) frequency response." />

<Img src="/物理学/电磁学/电路基础/fig-14-45.png" alt="Active band-pass filter." />

如上图所示，其传递函数为

$$
\begin{aligned}
\mathbf{H}(\omega) = \frac{\mathbf{V}_o}{\mathbf{V}_i} 
&= \left( -\frac{1}{1 + j \omega C_1 R} \right) \left( -\frac{j \omega C_2 R}{1 + j \omega C_2 R} \right)\left( -\frac{R_f}{R_i} \right)\\[8pt]
&= -\frac{R_f}{R_i} \cdot \frac{1}{1 + j \omega C_1 R} \cdot \frac{j \omega C_2 R}{1 + j \omega C_2 R}
\end{aligned}
$$

低通部分提供了上截止频率 (the upper corner frequency)

$$
\omega_2 = \frac{1}{R C_1}
$$

而高通部分提供了下截止频率 (the lower corner frequency)

$$
\omega_1 = \frac{1}{R C_2}
$$

因此，整体电路的中心频率 (the center frequency)、带宽、品质因数分别为

$$
\begin{aligned}
\omega_0 &= \sqrt{\omega_1 \omega_2}\\[8pt]
B &= \omega_2 - \omega_1\\[6pt]
Q &= \frac{\omega_0}{B}
\end{aligned}
$$

为了得到带通的增益 K，将传递函数表示为其标准形式

$$
\mathbf{H}(\omega) = -\frac{R_f}{R_i}\cdot \frac{j \omega / \omega_1}{(1 + j \omega / \omega_1)(1 + j \omega / \omega_2)}
$$

传递函数的模长为

$$
\left| \mathbf{H}(\omega_0) \right| = \left| \frac{R_f}{R_i} \cdot \frac{j \omega_0 / \omega_2}{(\omega_1 + j \omega_0)( \omega_2 + j \omega_0)} \right| = \frac{R_f}{R_i} \cdot \frac{\omega_2}{\omega_1 + \omega_2}
$$

因此，增益为

$$
K = \frac{R_f}{R_i} \cdot \frac{\omega_2}{\omega_1 + \omega_2}
$$

#### 带阻

<Img src="/物理学/电磁学/电路基础/fig-14-46.png" alt="Active band-reject filter: (a) block diagram, (b) frequency response." />

<Img src="/物理学/电磁学/电路基础/fig-14-47.png" alt="Active band-reject filter." />

带阻滤波器可以通过将一个低通滤波器和一个高通滤波器并联，并连接到一个反向加法放大器来构建。

如上图所示，其传递函数为

$$
\begin{aligned}
\mathbf{H}(\omega) = \frac{\mathbf{V}_o}{\mathbf{V}_i} 
&= -\frac{R_f}{R_i} \left( -\frac{1}{1 + j \omega C_1 R} - \frac{j \omega C_2 R}{1 + j \omega C_2 R} \right)\\[8pt]
&= \frac{R_f}{R_i} \cdot \frac{(1 + j 2 \omega / \omega_1 + (j \omega)^2 / \omega_1 \omega_1)}{(1 + j \omega / \omega_2)(1 + j \omega / \omega_1)}
\end{aligned}
$$

中心频率 $\omega_0$ 处的增益为

$$
K = H(\omega_0) = \frac{R_f}{R_i} \cdot \frac{2 \omega_1}{\omega_1 + \omega_2}
$$

> 这里出现的有源滤波器们，都是很简单的实现方案。实际上，还有更多更复杂的实现方案。

## 比例变换

Scaling


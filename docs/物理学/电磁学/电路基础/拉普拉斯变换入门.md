# 拉普拉斯变换入门

Introduction to the Laplace Transform

## 定义

对于一个给定的函数 $f(t)$，其拉普拉斯变换为：

$$
\mathcal{L}\left[f(t)\right] = F(s) = \int_{0^-}^\infty f(t) e^{-st} \mathrm{d}t
$$

其中， $s$ 是一个复变量，其定义为

$$
s = \sigma + j\omega
$$

The **Laplace transform** is an integral transformation of a function $f(t)$ from the time domain into the complex frequency domain, given by $F(s)$.

## 性质

### Linearity

$$
\mathcal{L}\left[a_1 f_1(t) + a_2 f_2(t)\right] = a_1 F_1(s) + a_2 F_2(s)
$$

### Scaling

$$
\mathcal{L}\left[f(at)\right] = \frac{1}{a} F\left(\frac{s}{a}\right)
$$

<details>
<summary style="cursor: pointer;">公式推导</summary>

$$
\begin{aligned}
\mathcal{L}\left[f(at)\right]
&= \int_{0^-}^\infty f(at) e^{-st} \mathrm{d}t\\[8pt]
&= \int_{0^-}^\infty f(at) e^{(-s/a)(at)} \frac{\mathrm{d}(at)}{a}\\[8pt]
&= \frac{1}{a} \int_{0^-}^\infty f(u) e^{-(s/a)u} \mathrm{d}u, \text{ where } u = at\\[8pt]
&= \frac{1}{a} F\left(\frac{s}{a}\right)
\end{aligned}
$$

</details>

### Time Shift

$$
\mathcal{L}\left[f(t-a)u(t-a)\right] = e^{-as} F(s), \text{ where } a\geq 0
$$

<details>
<summary style="cursor: pointer;">公式推导</summary>

$$
\begin{aligned}
\mathcal{L}\left[f(t-a)u(t-a)\right]
&= \int_{0^-}^\infty f(t-a)u(t-a) e^{-st} \mathrm{d}t\\[8pt]
&= \int_{t = a^-}^\infty f(t-a) e^{-st} \mathrm{d}t\\[8pt]
&= \int_{(t-a) = 0^-}^\infty f(t-a) e^{-s (t-a)} e^{-as} \mathrm{d}(t-a)\\[8pt]
&=  e^{-as} \int_{u = 0^-}^\infty f(u) e^{-s u}\mathrm{d}u, \text{ where } u = t-a\\[8pt]
&= e^{-as} F(s)
\end{aligned}
$$

</details>

### Frequency Shift

$$
\mathcal{L}\left[e^{-at}f(t)\right] = F(s+a)
$$

<details>
<summary style="cursor: pointer;">公式推导</summary>

$$
\begin{aligned}
\mathcal{L}\left[e^{-at}f(t)\right]
&= \int_{0^-}^\infty e^{-at}f(t) e^{-st} \mathrm{d}t\\[8pt]
&= \int_{0^-}^\infty f(t) e^{-(s+a)t} \mathrm{d}t\\[8pt]
&= F(s+a)
\end{aligned}
$$

</details>

### Time Differentiation

$$
\mathcal{L}\left[f^\prime (t)\right] = sF(s) - f(0^-)\\[8pt]
$$

<details>
<summary style="cursor: pointer;">公式推导</summary>

$$
\begin{aligned}
\mathcal{L}\left[f^\prime (t)\right]
&= \mathcal{L}\left[\frac{\mathrm{d}}{\mathrm{d}t} f(t)\right]\\[8pt]
&= \int_{0^-}^\infty \frac{\mathrm{d}}{\mathrm{d}t} f(t) e^{-st} \mathrm{d}t\\[8pt]
&= \int_{0^-}^\infty e^{-st} \mathrm{d}f(t)\\[8pt]
\text{分部积分法 }&= e^{-st} f(t) \Big|_{0^-}^\infty - \int_{0^-}^\infty f(t) \mathrm{d} (e^{-st})\\[8pt]
&= -f(0^-) - \int_{0^-}^\infty f(t) (-s e^{-st}) \mathrm{d}t\\[8pt]
&= -f(0^-) + s \int_{0^-}^\infty f(t) e^{-st} \mathrm{d}t\\[8pt]
&= s F(s) - f(0^-)
\end{aligned}
$$

</details>

<details>
<summary style="cursor: pointer;">分部积分法</summary>

$$
\int u\, \mathrm{d}v = uv - \int v\, \mathrm{d}u
$$

</details>

<details>
<summary style="cursor: pointer;">推广</summary>

$$
\begin{aligned}
\mathcal{L}\left[f^{\prime\prime} (t)\right]
&= s \mathcal{L}\left[f^\prime (t)\right] - f^\prime (0^-)\\[8pt]
&= s\left[sF(s) - f(0^-)\right] - f^\prime (0^-)\\[8pt] 
&= s^2 F(s) - s f(0^-) - f^\prime (0^-)\\[8pt]
\mathcal{L}\left[f^{n}(t)\right] 
&= s\cdot\mathcal{L}\left[f^{n-1}(t)\right] - f^{n-1}(0^-)\\[8pt]
\end{aligned}
$$

</details>

### Time Integration

$$
\mathcal{L}\left[\int_0^t f(\tau)\,\mathrm{d}\tau\right] = \frac{1}{s} F(s)
$$

<details>
<summary style="cursor: pointer;">公式推导</summary>

使用分部积分法，令

$$
\begin{aligned}
&u = \int_0^t f(\tau)\mathrm{d}\tau, &\mathrm{d}u = f(t)\mathrm{d}t\\[8pt]
&\mathrm{d}v = e^{-st}\mathrm{d}t, &v = -\frac{1}{s} e^{-st}
\end{aligned}
$$

于是

$$
\begin{aligned}
\mathcal{L}\left[\int_0^t f(\tau)\mathrm{d}\tau\right]
&= \int_{0^-}^\infty \left[\int_0^t f(\tau)\mathrm{d}\tau\right] e^{-st} \mathrm{d}t\\[8pt]
&= \left[\int_0^t f(\tau)\mathrm{d}\tau\right] \left(-\frac{1}{s} e^{-st}\right) \Big|_{0^-}^\infty 
- \int_{0^-}^\infty \left(-\frac{1}{s} e^{-st}\right) f(t) \mathrm{d}t\\[8pt]
&= 0 + \frac{1}{s} \int_{0^-}^\infty f(t) e^{-st} \mathrm{d}t\\[8pt]
&= \frac{1}{s} F(s)
\end{aligned}
$$

</details>

### Frequency Differentiation

$$
\mathcal{L}\left[t f(t)\right] = -\frac{\mathrm{d} F(s)}{\mathrm{d}s}
$$

<details>

<summary style="cursor: pointer;">公式推导</summary>

$$
\begin{aligned}
\frac{\mathrm{d}F(s)}{\mathrm{d}s}
&= \int_{0^-}^\infty f(t) (-t e^{-st}) \mathrm{d}t\\[8pt]
&= \int_{0^-}^\infty (-t f(t)) e^{-st} \mathrm{d}t\\[8pt]
&= \mathcal{L}\left[-t f(t)\right]
\end{aligned}
$$

Hence,

$$
\mathcal{L}\left[t f(t)\right] = -\frac{\mathrm{d} F(s)}{\mathrm{d}s}
$$

</details>

<details>

<summary style="cursor: pointer;">推广</summary>

$$
\mathcal{L}\left[t^n f(t)\right] = (-1)^n \frac{\mathrm{d}^n F(s)}{\mathrm{d}s^n}

$$

</details>

### Time Periodicity

$$
F(s) = \frac{F_1(s)}{1-e^{-Ts}}
$$

<details>

<summary style="cursor: pointer;">公式推导</summary>

对于满足以下性质的函数 $f(t)$

$$
f(t) = f(t - nT),\text{ where } n \in \mathbb{N}
$$

被称作周期函数。函数 $f(t)$ 可以表示为一组和

$$
\begin{aligned}
f(t)
&= f(t)[u(t)-u(t-T)]\\[8pt]
&\phantom{=}+ f(t)[u(t-T)-u(t-2T)]\\[8pt]
&\phantom{=}+ f(t)[u(t-2T)-u(t-3T)]\\[8pt]
&\phantom{=}+ \cdots\\[8pt]
&= f_1(t) + f_2(t) + f_3(t) + \cdots\\[8pt]
&= f_1(t) + f_1(t-T)u(t-T) + f_1(t-2T)u(t-2T) + \cdots
\end{aligned}
$$

其中，$f_1(t) = f(t)[u(t)-u(t-T)]$。

于是

$$
\begin{aligned}
F(s)
&= \mathcal{L}\left[f_1(t)\right] + \mathcal{L}\left[f_1(t-T)u(t-T)\right] + \mathcal{L}\left[f_1(t-2T)u(t-2T)\right] + \cdots\\[8pt]
&= F_1(s) + e^{-Ts} F_1(s) + e^{-2Ts} F_1(s) + \cdots\\[8pt]
&= F_1(s) \left[ 1 + e^{-Ts} + e^{-2Ts} + \cdots \right]
\end{aligned}
$$

利用几何级数公式

$$
1 + x + x^2 + \cdots = \frac{1}{1-x}, \text{ for } |x| < 1
$$

可知

$$
F(s) = \frac{F_1(s)}{1-e^{-Ts}}
$$

</details>

### Initial and Final Values

$$
\begin{aligned}
f(0) &= \lim_{s\to\infty} s F(s)\\[8pt]
f(\infty) &= \lim_{s\to 0} s F(s)
\end{aligned}
$$

<details>

<summary style="cursor: pointer;">公式推导 1</summary>

利用 the differentiation property，可知

$$
s F(s) - f(0) = \mathcal{L}\left[\frac{\mathrm{d}f}{\mathrm{d}t}\right] = \int_{0^-}^\infty \frac{\mathrm{d}f}{\mathrm{d}t} e^{-st} \mathrm{d}t
$$

因为 $\lim_{s\to\infty} e^{-st} = 0$，所以

$$
\lim_{s\to\infty} \left[s F(s) - f(0)\right] = 0
$$

因为 $f(0)$ 是常数，所以

$$
f(0) = \lim_{s\to\infty} s F(s)
$$

</details>

<details>

<summary style="cursor: pointer;">公式推导 2</summary>

$$
\lim_{s\to 0} \left[ s F(s) - f(0^-) \right] = \int_{0^-}^\infty \frac{\mathrm{d}f}{\mathrm{d}t} e^{0t} \mathrm{d}t = \int_{0^-}^\infty \mathrm{d}f = f(\infty) - f(0^-)
$$

于是

$$
f(\infty) = \lim_{s\to 0} s F(s)
$$

</details>

## 拉普拉斯逆变换

The Inverse Laplace Transform

$$
\mathcal{L}^{-1} \left[ F(s) \right] = f(t) = \frac{1}{2\pi j}\int_{\sigma_1-j\infty}^{\sigma_1+j\infty} F(s) e^{st} \mathrm{d}s\\[20pt]
$$

$$
F(s) = \frac{N(s)}{D(s)}
$$

```python
import sympy as sp
import IPython.display as display
s = sp.symbols('s', complex=True)
t = sp.symbols('t', real=True)
F = 1 / s
# 输出：
# $\displaystyle \theta\left(t\right)$
f = sp.inverse_laplace_transform(F, s, t)
display(f)
```

## 卷积积分

The Convolution Integral

### 定义

$$
y(t) = \int_{-\infty}^{\infty} x(\lambda) h(t-\lambda)\, \mathrm{d}\lambda
$$

或

$$
y(t) = x(t) * h(t)
$$

如果
1. 当 $t<0$ 时，$x(t)=0$
2. 当 $t<\lambda$ 时，$h(t-\lambda)=0$

那么

$$
y(t) = h(t) * x(t) = \int_0^t x(\lambda) h(t-\lambda)\,\mathrm{d}\lambda
$$

### 性质

1. $x(t)*h(t)=h(t)*x(t)$

2. $f(t)*[x(t)+y(t)]=f(t)*x(t)+f(t)*y(t)$

3. $f(t)*[x(t)*y(t)]=[f(t)*x(t)]*y(t)$

4. $f(t)*\delta(t)=f(t)$

5. $f(t)*\delta(t-t_0)=f(t-t_0)$

6. $f(t)*\delta^\prime (t)=f^\prime (t)$

7. $f(t)*u(t)=\int_{-\infty}^t f(\lambda) \,\mathrm{d}\lambda$

### 与拉普拉斯变换的关系

假设 $f_1(t)$ 和 $f_2(t)$ 的拉普拉斯变换分别为 $F_1(s)$ 和 $F_2(s)$，那么

$$
\boxed{
F_1(s)F_2(s) = \mathcal{L}\left[f_1(t)*f_2(t)\right]
}
$$

<details>
<summary style="cursor: pointer;">Python 示例</summary>

```python
# Example 15.12
# Page 698

import sympy as sp
# 我们要计算 x_1(t) 和 x_2(t) 的卷积:
# y(t) = ∫ x_1(λ) * x_2(t-λ) dλ, λ 从 0 到 t

t = sp.symbols('t', real=True)
lam = sp.symbols('\\lambda', real=True)

x_1 = 2 * (sp.Heaviside(t) - sp.Heaviside(t-1))
x_2 = (sp.Heaviside(t-1) - sp.Heaviside(t-3))

# 卷积表达式，注意 x_2 用 t-lam
y_conv = sp.integrate(x_1.subs(t, lam) * x_2.subs(t, t - lam), (lam, 0, t))
display(y_conv.simplify())

# 作图验证
import matplotlib.pyplot as plt
import numpy as np

# 将 y_conv 转换为可用于数值计算的函数
conv_func = sp.lambdify(t, y_conv, modules=['numpy'])

ts = np.linspace(0, 5, 301)
ys = conv_func(ts)

plt.figure(figsize=(7,4))
plt.plot(ts, ys, label=r'$y(t)$')
plt.xlabel('$t$')
plt.ylabel('卷积值')
plt.title('x_1(t) 和 x_2(t) 的卷积图像, $t \\in [0,5]$')
plt.rcParams['font.sans-serif'] = ['SimHei']  # 设置中文字体为黑体，避免中文乱码
plt.rcParams['axes.unicode_minus'] = False    # 正常显示负号
plt.grid(True)
plt.legend()
plt.show()
```

</details>
# 傅里叶级数

## 三角傅里叶级数

Trigonometric Fourier Series

对于周期函数

$$
f(t) = f(t + n T)
$$

其傅里叶级数形式为

$$
f(t) = a_0 + \sum_{n=1}^{\infty} (a_n \cos n \omega_0 t + b_n \sin n \omega_0 t)
$$

其中

- $\omega_0 = \frac{2\pi}{T}$: The fundamental angular frequency.

- $\sin n \omega_0 t$ or $\cos n \omega_0 t$: The n-th harmonic of f(t).

- $a_n$ and $b_n$: The Fourier coefficients.

- $a_0$: The dc component or the average value of f(t).

The Fourier series of a periodic function f(t) is a representation that resolves f(t) into a dc component and an ac component comprising an infinite series of harmonic sinusoids.

## 狄利克雷条件

Dirichlet Conditions

1. **单值性 (Single-valued)**：在任意时刻 t，函数 f(t) 只能有一个值。

    - 物理意义：现实世界中的电压不可能在同一瞬间既是 5V 又是 10V。

2. **绝对可积性 (Absolutely integrable)**：在一个周期内，函数的绝对值积分必须是有限的：

    $$
    \int_{t_0}^{t_0 + T} |f(t)|\, \mathrm{d}t < \infty
    $$

    - 物理意义：这意味着信号在一个周期内的**面积**是有限的。如果一个电压信号无穷大（像 $\frac{1}{t}$ 在 $t=0$ 处那样），它就无法展开为傅里叶级数。

3. **有限个有限间断点 (Finite number of finite discontinuities)**：在一个周期内，不连续点（跳变点）的**数量**必须是有限的，且每个断点的**跳变幅度**必须是有限的。

    - 例子：像方波、锯齿波这样有“悬崖”波形的函数。

4. **有限个极大值和极小值 (Finite number of maxima and minima)**：在一个周期内，波峰和波谷的数量必须是有限的。

    - 反例：函数 $\sin(1/t)$ 在 $t\to 0$ 时会发生无穷次震荡，因此它无法展开为傅里叶级数。

## 三角函数工具

这部分记录一些三角函数工具，在推导傅里叶级数系数时可能会用到。

### 三角函数的正交性

Orthogonality of Trigonometric Functions

1. 单个正弦或余弦的积分

$$
\int_{0}^{T} \cos n \omega_0 t \, \mathrm{d}t = 0
$$

$$
\int_{0}^{T} \sin n \omega_0 t \, \mathrm{d}t = 0
$$

2. 不同类型的函数相乘

$$
\int_{0}^{T} \cos n \omega_0 t \sin m \omega_0 t \, \mathrm{d}t = 0
$$

3. 同类型函数相乘

$$\int_0^T \cos n \omega_0 t \cos m \omega_0 t \, dt =
\begin{cases}
0, & \text{if } n \neq m \\[8pt]
\displaystyle\frac{T}{2}, & \text{if } n = m
\end{cases}$$

$$\int_0^T \sin n \omega_0 t \sin m \omega_0 t \, dt =
\begin{cases}
0, & \text{if } n \neq m \\[8pt]
\displaystyle\frac{T}{2}, & \text{if } n = m
\end{cases}$$

### 三角函数的积分

$$
\begin{aligned}
&\int \cos a t \, \mathrm{d}t = \frac{1}{a} \sin a t \\[8pt]
&\int \sin a t \, \mathrm{d}t = -\frac{1}{a} \cos a t \\[8pt]
&\int t \cos a t \, \mathrm{d}t = \frac{1}{a^2} \cos a t + \frac{1}{a} t \sin a t \\[8pt]
&\int t \sin a t \, \mathrm{d}t = \frac{1}{a^2} \sin a t - \frac{1}{a} t \cos a t
\end{aligned}
$$

### 三角函数的取值

$$
\begin{array}{|l|l|}
\hline
\textbf{Function} & \textbf{Value} \\
\hline
\cos 2 n \pi & 1 \\
\hline
\sin 2 n \pi & 0 \\
\hline
\cos n \pi & (-1)^n \\
\hline
\sin n \pi & 0 \\
\hline
\cos \frac{n \pi}{2} & \begin{cases} (-1)^{n/2}, & n \text{ is even} \\[8pt] 0, & n \text{ is odd} \end{cases} \\
\hline
\sin \frac{n \pi}{2} & \begin{cases} (-1)^{(n-1)/2}, & n \text{ is odd} \\[8pt] 0, & n \text{ is even} \end{cases} \\
\hline
e^{j 2 n \pi} & 1 \\
\hline
e^{j n \pi} & (-1)^n \\
\hline
e^{j n \pi / 2} & \begin{cases} (-1)^{n/2}, & n \text{ is even} \\[8pt] j (-1)^{(n-1)/2}, & n \text{ is odd} \end{cases} \\
\hline
\end{array}
$$

## 傅里叶分析

Fourier Analysis

确定系数 $a_0$, $a_n$, $b_n$ 的过程称为傅里叶分析。

$$
a_0 = \frac{1}{T} \int_{0}^{T} f(t) \, \mathrm{d}t
$$

<details>
<summary onmouseover="this.style.cursor='pointer'">推导过程</summary>

为了得到系数 $a_0$，我们对傅里叶级数两边同时对 $t$ 从 $0$ 到 $T$ 积分

$$
\begin{aligned}
\int_{0}^{T} f(t) \, \mathrm{d}t 
&= \int_{0}^{T} \left[a_0 + \sum_{n=1}^{\infty} (a_n \cos n \omega_0 t + b_n \sin n \omega_0 t)\right] \, \mathrm{d}t \\[8pt]
&= \int_{0}^{T} a_0 \, \mathrm{d}t + \sum_{n=1}^{\infty} \int_{0}^{T} (a_n \cos n \omega_0 t + b_n \sin n \omega_0 t) \, \mathrm{d}t \\[8pt]
&= \int_{0}^{T} a_0 \, \mathrm{d}t + 0 \\[8pt]
&= a_0 T
\end{aligned}
$$

于是有

$$
a_0 = \frac{1}{T} \int_{0}^{T} f(t) \, \mathrm{d}t
$$

<hr/>
</details>

$$
a_n = \frac{2}{T} \int_{0}^{T} f(t) \cos n \omega_0 t \, \mathrm{d}t
$$

<details>
<summary onmouseover="this.style.cursor='pointer'">推导过程</summary>

为了得到 $a_n$，我们首先对傅里叶级数两边同时乘以 $\cos m \omega_0 t$，然后对 $t$ 从 $0$ 到 $T$ 积分。因此有

$$
\begin{aligned}
\int_{0}^{T} f(t) \cos m \omega_0 t \, \mathrm{d}t
&= \int_{0}^{T} \left[a_0 + \sum_{n=1}^{\infty} (a_n \cos n \omega_0 t + b_n \sin n \omega_0 t)\right] \cos m \omega_0 t \, \mathrm{d}t \\[8pt]
&= \int_{0}^{T} a_0 \cos m \omega_0 t \, \mathrm{d}t + \sum_{n=1}^{\infty} \left(\int_{0}^{T} a_n \cos n \omega_0 t \cos m \omega_0 t \, \mathrm{d}t \right. \\[8pt]
&\phantom{=} \left. + \int_{0}^{T} b_n \sin n \omega_0 t \cos m \omega_0 t \, \mathrm{d}t\right) \\[8pt]
&=
\begin{cases} 
0, & n \neq m \\[8pt] 
\displaystyle\int_{0}^{T} a_n \cos n \omega_0 t \cos n \omega_0 t \, \mathrm{d}t = a_n \frac{T}{2}, & n = m 
\end{cases} 
\end{aligned}
$$

于是有

$$
a_n = \frac{2}{T} \int_{0}^{T} f(t) \cos n \omega_0 t \, \mathrm{d}t
$$

<hr/>
</details>

$$
b_n = \frac{2}{T} \int_{0}^{T} f(t) \sin n \omega_0 t \, \mathrm{d}t
$$

<details>
<summary onmouseover="this.style.cursor='pointer'">推导过程</summary>

$b_n$ 的推导过程与 $a_n$ 类似，这里不再赘述。

<hr/>
</details>


如果将傅里叶级数展开表达为 amplitude-phase 形式

$$
f(t) = a_0 + \sum_{n=1}^{\infty} A_n \cos (n \omega_0 t + \phi_n)
$$

则有

$$
A_n = \sqrt{a_n^2 + b_n^2}\quad,\quad \phi_n = - \tan^{-1} \frac{b_n}{a_n}
$$

<details>
<summary onmouseover="this.style.cursor='pointer'">推导过程</summary>

将 amplitude-phase 形式展开

$$
\begin{aligned}
f(t) 
&= a_0 + \sum_{n=1}^{\infty} A_n \cos (n \omega_0 t + \phi_n) \\[8pt]
&= a_0 + \sum_{n=1}^{\infty} A_n \left( \cos n \omega_0 t \cos \phi_n - \sin n \omega_0 t \sin \phi_n \right) \\[8pt]
&= a_0 + \sum_{n=1}^{\infty} \left( A_n \cos \phi_n \cos n \omega_0 t - A_n \sin \phi_n \sin n \omega_0 t \right)
\end{aligned}
$$

显然

$$
A_n \cos \phi_n = a_n,\quad - A_n \sin \phi_n = b_n
$$

于是有

$$
A_n = \sqrt{a_n^2 + b_n^2},\quad \phi_n = - \tan^{-1} \frac{b_n}{a_n}
$$

<hr/>
</details>

## 对称性分析

### 偶函数

满足以下条件的函数称为偶函数

$$
f(t) = f(-t)
$$

偶函数有一个重要的性质

$$
\int_{-T/2}^{T/2} f_e(t) \, \mathrm{d}t = 2 \int_{0}^{T/2} f_e(t) \, \mathrm{d}t
$$

利用偶函数的这个性质，傅里叶级数的系数可以表示为

$$
a_0 = \frac{2}{T} \int_{0}^{T/2} f(t) \, \mathrm{d}t
$$

$$
a_n = \frac{4}{T} \int_{0}^{T/2} f(t) \cos n \omega_0 t \, \mathrm{d}t
$$

$$
b_n = 0
$$

### 奇函数

满足以下条件的函数称为奇函数

$$
f(-t) = -f(t)
$$

奇函数有一个重要的性质

$$
\int_{-T/2}^{T/2} f_o(t) \, \mathrm{d}t = 0
$$

利用奇函数的这个性质，傅里叶级数的系数可以表示为

$$
a_0 = 0
$$

$$
a_n = 0
$$

$$
b_n = \frac{4}{T} \int_{0}^{T/2} f(t) \sin n \omega_0 t \, \mathrm{d}t
$$

### 半波对称性

Half-Wave Symmetry

满足以下条件的函数称为半波对称性

$$
f(t-\frac{T}{2}) = -f(t)
$$

它的傅里叶系数为

$$
a_0 = 0
$$

$$
a_n = \begin{cases}
\displaystyle\frac{4}{T} \int_{0}^{T/2} f(t) \cos n \omega_0 t \, \mathrm{d}t, & n \text{ is odd} \\[8pt]
0, & n \text{ is even}
\end{cases}
$$

$$
b_n = \begin{cases}
\displaystyle\frac{4}{T} \int_{0}^{T/2} f(t) \sin n \omega_0 t \, \mathrm{d}t, & n \text{ is odd} \\[8pt]
0, & n \text{ is even}
\end{cases}
$$


<Img src="/物理学/电磁学/电路基础/table-17-2-3.svg" alt="table-17-2-3" maxHeight="auto" />

## 电路应用

$$
v(t) = V_0 + \sum_{n=1}^{\infty} V_n \cos (n \omega_0 t + \theta_n)
$$
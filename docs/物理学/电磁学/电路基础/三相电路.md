# 三相电路

Three-Phase Circuits

> 在电力系统中，除非另有说明，本文中的电压和电流均以有效值 (rms) 值表示，这是一个普遍的惯例。

<Img src="/物理学/电磁学/电路基础/fig-12-1-2-3.png" alt="phase-system" />

<Img src="/物理学/电磁学/电路基础/three-phase-system.png" alt="three-phase-system" maxHeight="200px" />

## 平衡三相电压

Balanced Phase Voltages

<Img src="/物理学/电磁学/电路基础/fig-12-6.png" alt="Three-phase voltage sources: (a) Y-connected source, (b) ∆-connected source." maxHeight="180px" />

**Balanced phase voltages** are equal in magnitude and are out of phase with each other by 120&deg;.

The **phase sequence** is the time order in which the voltages pass through their respective maximum values.

> 除非另有说明，本文中默认采用 positive sequence 的相序（顺时针方向）。

$$
\begin{aligned}
&\mathbf{V}_{an} + \mathbf{V}_{bn} + \mathbf{V}_{cn} = 0\\[8pt]
&|\mathbf{V}_{an}| = |\mathbf{V}_{bn}| = |\mathbf{V}_{cn}| = V_p\\[8pt]
&\mathbf{V}_{an} = V_p \angle 0\degree\\[8pt]
&\mathbf{V}_{bn} = V_p \angle -120\degree\\[8pt]
&\mathbf{V}_{cn} = V_p \angle -240\degree = V_p \angle 120\degree
\end{aligned}
$$

## 平衡负载

Balanced Load

<Img src="/物理学/电磁学/电路基础/fig-12-8.png" alt="Two possible three-phase load configurations: (a) a Y-connected load, (b) a ∆-connected load." maxHeight="200px" />

A **balanced load** is one in which the phase impedances are equal in magnitude and in phase.

$$
\begin{aligned}
&\mathbf{Z}_1 = \mathbf{Z}_2 = \mathbf{Z}_3 = \mathbf{Z}_Y\\[8pt]
&\mathbf{Z}_a = \mathbf{Z}_b = \mathbf{Z}_c = \mathbf{Z}_{\Delta}\\[8pt]
&\mathbf{Z}_{\Delta} = 3 \mathbf{Z}_Y\\[8pt]
&\mathbf{Z}_Y = \frac{1}{3} \mathbf{Z}_{\Delta}
\end{aligned}
$$

## 平衡连接

### Y-Y

Balanced Wye-Wye Connection

A **balanced Y-Y system** is a three-phase system with a balanced Y-connected source and a balanced Y-connected load.

<Img src="/物理学/电磁学/电路基础/fig-12-9.png" alt="A balanced Y-Y system, showing the source, line, and load impedances."/>

$$
Z_Y = Z_s + Z_l + Z_L
$$

通常，Z<sub>s</sub> 和 Z<sub>&ell;</sub> 相比 Z<sub>L</sub> 非常小，因此可以假设 Z<sub>Y</sub> = Z<sub>L</sub>（如果Z<sub>s</sub> 和 Z<sub>&ell;</sub>没有给定，则默认它们为零）。

<Img src="/物理学/电磁学/电路基础/fig-12-10.png" alt="Balanced Y-Y connection." maxHeight="256px"/>

The *line-to-line* voltages or simply *line* voltages are related to the phase voltages.

**线电压**的计算：

$$
\begin{aligned}
\mathbf{V}_{ab} &= \mathbf{V}_{an} + \mathbf{V}_{nb} = \mathbf{V}_{an} - \mathbf{V}_{bn}\\[8pt]
&= V_p \angle 0\degree - V_p \angle -120\degree\\[8pt]
&= V_p(\cos 0\degree + j \sin 0\degree - \cos (-120\degree) - j \sin (-120\degree))\\[4pt]
&= V_p(1 + 0 + \frac{1}{2} + j \frac{\sqrt{3}}{2})\\[8pt]
&= \sqrt{3} V_p \angle 30\degree\\[8pt]
\text{Similarly,}\quad\mathbf{V}_{bc} &= \sqrt{3} V_p \angle -90\degree\\[8pt]
\mathbf{V}_{ca} &= \sqrt{3} V_p \angle -210\degree
\end{aligned}
$$

因此，线电压（火线与火线之间的电压） V<sub>L</sub> 的大小为 $\sqrt{3}$ 倍的相电压（火线与零线之间的电压） V<sub>p</sub>，并且线电压的相位比相电压的相位超前 30&deg;。

> The line voltages lead their corresponding phase voltages by 30&deg;.

$$
\begin{aligned}
&V_L = \sqrt{3} V_p\\[8pt]
&V_p = |\mathbf{V}_{an}| = |\mathbf{V}_{bn}| = |\mathbf{V}_{cn}|\\[8pt]
&V_L = |\mathbf{V}_{ab}| = |\mathbf{V}_{bc}| = |\mathbf{V}_{ca}|
\end{aligned}
$$

<Img src="/物理学/电磁学/电路基础/fig-12-11.png" alt="Phasor diagrams illustrating the relationship between line voltages and phase voltages." maxHeight="256px"/>

**线电流**的计算：

$$
\begin{aligned}
&\mathbf{I}_a = \frac{\mathbf{V}_{an}}{\mathbf{Z}_Y}\\[8pt]
&\mathbf{I}_b = \frac{\mathbf{V}_{bn}}{\mathbf{Z}_Y} = \frac{\mathbf{V}_{an}\angle -120\degree}{\mathbf{Z}_Y} = \mathbf{I}_a\angle -120\degree\\[8pt]
&\mathbf{I}_c = \frac{\mathbf{V}_{cn}}{\mathbf{Z}_Y} = \frac{\mathbf{V}_{an}\angle -240\degree}{\mathbf{Z}_Y} = \mathbf{I}_a\angle -240\degree\\[8pt]
&\mathbf{I}_a + \mathbf{I}_b + \mathbf{I}_c = 0\\[8pt]
&\mathbf{I}_n = - (\mathbf{I}_a + \mathbf{I}_b + \mathbf{I}_c) = 0\\[8pt]
&\mathbf{V}_{nN} = \mathbf{Z}_n\mathbf{I}_n = 0
\end{aligned}
$$

即中性线（零线）上的电压为零。因此，可以去掉中性线而不影响系统。实际上，在长距离电力传输中，使用的是三根或其倍数的导线，而以大地本身作为中性导体。如此设计的电力系统在所有关键点都进行了良好的接地，以确保安全。

### Y-∆

Balanced Y-∆ Connection

<Img src="/物理学/电磁学/电路基础/fig-12-14.png" alt="Balanced Y-∆ connection." maxHeight="256px"/>

<Img src="/物理学/电磁学/电路基础/fig-12-15.png" alt="Phasor diagram illustrating the relationship between phase and line currents." maxHeight="256px"/>

<!-- Jupyter Notebook Start -->

如图所示，其中
- $\mathbf{V}_{an}, \mathbf{V}_{bn}, \mathbf{V}_{cn}$ 为相电压
- $\mathbf{Z}_{\Delta}$ 为三角形负载阻抗
- $\mathbf{V}_{AB}, \mathbf{V}_{BC}, \mathbf{V}_{CA}$ 为线电压（负载电压）
- $\mathbf{I}_{AB}, \mathbf{I}_{BC}, \mathbf{I}_{CA}$ 为相电流（负载电流）
- $\mathbf{I}_a, \mathbf{I}_b, \mathbf{I}_c$ 为线电流

另外，规定
- 相电压的幅值为 $V_p$
- 负载阻抗两端电压的幅值为 $V_Z$
- 相电流的幅值为 $I_p$
- 线电流的幅值为 $I_L$


```python
import sympy as sp # 导入 sympy 库并简写为 sp
from IPython.display import display, Math, HTML

j = sp.I  # 定义虚数单位 j
```


```python
# 列出已知量
V_p = sp.symbols('V_p', real=True, positive=True) # 正实数
V_an = V_p * sp.exp(j * 0) # 复数
V_bn = V_p * sp.exp(j * sp.rad(-120)) # 复数
V_cn = V_p * sp.exp(j * sp.rad(120)) # 复数
Z_Delta = sp.symbols(r'\mathbf{Z}_{\Delta}', complex=True) # 复数
# 打印已知量
display(Math(sp.latex(sp.Eq(sp.Symbol('V_p'), V_p)))), 
display(Math(sp.latex(sp.Eq(sp.Symbol(r'\mathbf{V}_{an}'), V_an)))), 
display(Math(sp.latex(sp.Eq(sp.Symbol(r'\mathbf{V}_{bn}'), V_bn)))), 
display(Math(sp.latex(sp.Eq(sp.Symbol(r'\mathbf{V}_{cn}'), V_cn)))), 
display(Math(sp.latex(sp.Eq(sp.Symbol(r'\mathbf{Z}_{\Delta}'), Z_Delta))))

# 优化打印（极坐标形式）
display(HTML('<p><b>优化打印（极坐标形式）：</b></p>'))
def display_polar(name, expr):
    r = sp.nsimplify(sp.sqrt(sp.re(expr)**2 + sp.im(expr)**2))
    theta = sp.deg(sp.atan2(sp.im(expr), sp.re(expr)))
    display(Math(rf"{name} = {sp.latex(r)}\,\angle\,{sp.latex(theta)}^\circ"))
    
display_polar(r'\mathbf{V}_{an}', V_an)
display_polar(r'\mathbf{V}_{bn}', V_bn)
display_polar(r'\mathbf{V}_{cn}', V_cn)
```


$\displaystyle V_{p} = V_{p}$



$\displaystyle \mathbf{V}_{an} = V_{p}$



$\displaystyle \mathbf{V}_{bn} = V_{p} e^{- \frac{2 i \pi}{3}}$



$\displaystyle \mathbf{V}_{cn} = V_{p} e^{\frac{2 i \pi}{3}}$



$\displaystyle \mathbf{Z}_{\Delta} = \mathbf{Z}_{\Delta}$



<p><b>优化打印（极坐标形式）：</b></p>



$\displaystyle \mathbf{V}_{an} = V_{p}\,\angle\,0^\circ$



$\displaystyle \mathbf{V}_{bn} = V_{p}\,\angle\,-120^\circ$



$\displaystyle \mathbf{V}_{cn} = V_{p}\,\angle\,120^\circ$



```python
# 求解线电压
display(HTML('<p><b>线电压（负载电压）：</b></p>'))
# 如图，显然 
# V_AB = V_an + V_nb = V_an - V_bn, 
# V_BC = V_bn + V_nc = V_bn - V_cn, 
# V_CA = V_cn + V_na = V_cn - V_an
# 因此
V_AB = V_an - V_bn
V_BC = V_bn - V_cn
V_CA = V_cn - V_an
# 打印线电压
display(Math(sp.latex(sp.Eq(sp.Symbol(r'\mathbf{V}_{AB}'), V_AB))))
display(Math(sp.latex(sp.Eq(sp.Symbol(r'\mathbf{V}_{BC}'), V_BC))))
display(Math(sp.latex(sp.Eq(sp.Symbol(r'\mathbf{V}_{CA}'), V_CA))))

# 优化打印（极坐标形式）
display(HTML('<p><b>优化打印（极坐标形式）：</b></p>'))
def display_polar(name, expr):
    r = sp.nsimplify(sp.sqrt(sp.re(expr)**2 + sp.im(expr)**2))
    theta = sp.nsimplify(sp.deg(sp.atan2(sp.im(expr), sp.re(expr))))
    display(Math(sp.latex(sp.Symbol(name)) + '=' + sp.latex(r) + r'\angle' + sp.latex(theta) + r'\degree'))

display_polar(r'\mathbf{V}_{AB}', V_AB)
display_polar(r'\mathbf{V}_{BC}', V_BC)
display_polar(r'\mathbf{V}_{CA}', V_CA)

# 因此，$V_Z = \sqrt{3}V_p$
display(HTML('<p><b>因此，负载的端电压的幅值是相电压的根号3倍。</b></p>'))
display(Math(fr'$V_Z = \sqrt{3} V_p$'))
```


<p><b>线电压（负载电压）：</b></p>



$\displaystyle \mathbf{V}_{AB} = V_{p} - V_{p} e^{- \frac{2 i \pi}{3}}$



$\displaystyle \mathbf{V}_{BC} = V_{p} e^{- \frac{2 i \pi}{3}} - V_{p} e^{\frac{2 i \pi}{3}}$



$\displaystyle \mathbf{V}_{CA} = - V_{p} + V_{p} e^{\frac{2 i \pi}{3}}$



<p><b>优化打印（极坐标形式）：</b></p>



$\displaystyle \mathbf{V}_{AB}=\sqrt{3} V_{p}\angle30\degree$



$\displaystyle \mathbf{V}_{BC}=\sqrt{3} V_{p}\angle-90\degree$



$\displaystyle \mathbf{V}_{CA}=\sqrt{3} V_{p}\angle150\degree$



<p><b>因此，负载的端电压的幅值是相电压的根号3倍。</b></p>



$\displaystyle V_Z = \sqrt3 V_p$



```python
# 相电流 I_AB, I_BC, I_CA 的幅值为 I_p
# 线电流 I_a, I_b, I_c 的幅值为 I_L
# 在节点 A, B, C 处，应用 KCL
# I_a = I_AB - I_CA,
# I_b = I_BC - I_AB,
# I_c = I_CA - I_BC
```


```python
# 相电流（复数） I_p: I_AB, I_BC, I_CA
I_AB = V_AB / Z_Delta
I_BC = V_BC / Z_Delta
I_CA = V_CA / Z_Delta
# 打印相电流
display(HTML('<p><b>相电流：</b></p>'))
display(Math(sp.latex(sp.Eq(sp.Symbol(r'\mathbf{I}_{AB}'), I_AB))))
display(Math(sp.latex(sp.Eq(sp.Symbol(r'\mathbf{I}_{BC}'), I_BC))))
display(Math(sp.latex(sp.Eq(sp.Symbol(r'\mathbf{I}_{CA}'), I_CA))))
```


<p><b>相电流：</b></p>



$\displaystyle \mathbf{I}_{AB} = \frac{V_{p} - V_{p} e^{- \frac{2 i \pi}{3}}}{\mathbf{Z}_{\Delta}}$



$\displaystyle \mathbf{I}_{BC} = \frac{V_{p} e^{- \frac{2 i \pi}{3}} - V_{p} e^{\frac{2 i \pi}{3}}}{\mathbf{Z}_{\Delta}}$



$\displaystyle \mathbf{I}_{CA} = \frac{- V_{p} + V_{p} e^{\frac{2 i \pi}{3}}}{\mathbf{Z}_{\Delta}}$



```python
# 线电流（复数） I_L: I_a, I_b, I_c
I_a = I_AB - I_CA
I_b = I_BC - I_AB
I_c = I_CA - I_BC
# 打印线电流
display(HTML('<p><b>线电流：</b></p>'))
display(Math(sp.latex(sp.Eq(sp.Symbol(r'\mathbf{I}_a'), I_a))))
display(Math(sp.latex(sp.Eq(sp.Symbol(r'\mathbf{I}_b'), I_b))))
display(Math(sp.latex(sp.Eq(sp.Symbol(r'\mathbf{I}_c'), I_c)))) 
```


<p><b>线电流：</b></p>



$\displaystyle \mathbf{I}_a = - \frac{- V_{p} + V_{p} e^{\frac{2 i \pi}{3}}}{\mathbf{Z}_{\Delta}} + \frac{V_{p} - V_{p} e^{- \frac{2 i \pi}{3}}}{\mathbf{Z}_{\Delta}}$



$\displaystyle \mathbf{I}_b = - \frac{V_{p} - V_{p} e^{- \frac{2 i \pi}{3}}}{\mathbf{Z}_{\Delta}} + \frac{V_{p} e^{- \frac{2 i \pi}{3}} - V_{p} e^{\frac{2 i \pi}{3}}}{\mathbf{Z}_{\Delta}}$



$\displaystyle \mathbf{I}_c = \frac{- V_{p} + V_{p} e^{\frac{2 i \pi}{3}}}{\mathbf{Z}_{\Delta}} - \frac{V_{p} e^{- \frac{2 i \pi}{3}} - V_{p} e^{\frac{2 i \pi}{3}}}{\mathbf{Z}_{\Delta}}$



```python
# 线电流的幅值和相电流的幅值的比值关系
ratio = sp.Abs(I_a) / sp.Abs(I_AB) # 通过 sympy 计算比值
display(Math(r'\frac{I_L}{I_p} = ' + sp.latex(ratio.simplify())))
display(HTML('<p><b>因此，线电流的幅值是相电流幅值的根号3倍。</b></p>'))
display(Math(r'I_L = ' + sp.latex(ratio.simplify()) + r' I_p'))
```


$\displaystyle \frac{I_L}{I_p} = \sqrt{3}$



<p><b>因此，线电流的幅值是相电流幅值的根号3倍。</b></p>



$\displaystyle I_L = \sqrt{3} I_p$



<!-- Jupyter Notebook End -->

**补充**

对于 ∆ 形负载，可以将其转换为 Y 形负载，然后进行分析

$$
\mathbf{Z}_Y= \frac{\mathbf{Z}_{\Delta}}{3} 
$$

根据欧姆定律，线电流的幅值可以表示为相电压与负载阻抗的模的比值。

$$
I_L = \left| \frac{\mathbf{V}_{p}}{\mathbf{Z}_Y} \right| = 3 \left| \frac{\mathbf{V}_{p}}{\mathbf{Z}_{\Delta}} \right| 
$$

其中 $| \mathbf{V}_{p} | = | \mathbf{V}_{an} | = | \mathbf{V}_{bn} | = | \mathbf{V}_{cn} |$。

### ∆-∆

<Img src="/物理学/电磁学/电路基础/fig-12-17.png" alt="A balanced ∆-∆ connection." maxHeight="256px"/>

如图所示。

相电压等于线电压

$$
\mathbf{V}_{ab} = \mathbf{V}_{AB},\quad \mathbf{V}_{bc} = \mathbf{V}_{BC},\quad \mathbf{V}_{ca} = \mathbf{V}_{CA}
$$

于是相电流（负载电流）为

$$
\mathbf{I}_{AB} = \frac{\mathbf{V}_{AB}}{\mathbf{Z}_{\Delta}} = \frac{\mathbf{V}_{ab}}{\mathbf{Z}_{\Delta}},\quad \mathbf{I}_{BC} = \frac{\mathbf{V}_{BC}}{\mathbf{Z}_{\Delta}} = \frac{\mathbf{V}_{bc}}{\mathbf{Z}_{\Delta}},\quad \mathbf{I}_{CA} = \frac{\mathbf{V}_{CA}}{\mathbf{Z}_{\Delta}} = \frac{\mathbf{V}_{ca}}{\mathbf{Z}_{\Delta}}
$$

由于负载呈 ∆ 形，所以线电流为

$$
I_L = \sqrt{3} I_p
$$

### ∆-Y

<Img src="/物理学/电磁学/电路基础/fig-12-18.png" alt="A balanced ∆-Y connection." maxHeight="256px"/>
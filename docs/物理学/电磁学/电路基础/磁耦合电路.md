# 磁耦合电路

Magnetically Coupled Circuits

## 互感系数

Mutual Inductance

<Img src="/物理学/电磁学/电路基础/fig-13-1.png" alt="Magnetic flux produced by a single coil with N turns." maxHeight="180px" />

考虑这样的一个电感器，其线圈匝数为 N。当电流 i 流过线圈时，产生磁通量 ϕ。根据法拉第定律，产生的感应电压 v 与匝数 N 和磁通量 ϕ 对时间的变化率成正比：

$$
v = N \frac{\mathrm{d}\phi}{\mathrm{d}t}
$$

由于磁通量来源于电流，因此磁通量的任何变化必然由电流的变化所致。由此，感应电压 v 还可以表达为：

$$
\begin{aligned}
v &= N \frac{\mathrm{d}\phi}{\mathrm{d}i} \frac{\mathrm{d}i}{\mathrm{d}t}\\[8pt]
&= L \frac{\mathrm{d}i}{\mathrm{d}t}
\end{aligned}
$$

其中，

$$
L = N \frac{\mathrm{d}\phi}{\mathrm{d}i}
$$

被称为**自感系数** (self-inductance)，其单位为亨利 (H)。

<hr/>

<Img src="/物理学/电磁学/电路基础/fig-13-2.png" alt="Mutual inductance M21 of coil 2 with
respect to coil 1." maxHeight="200px" />

现在考虑两个自感量分别为 L<sub>1</sub> 和 L<sub>2</sub> 的线圈，它们彼此靠近。线圈 1 有 N<sub>1</sub> 匝，线圈 2 有 N<sub>2</sub> 匝。简单起见，假设第二个电感没有电流流过。来自线圈 1 的磁通量 ϕ<sub>1</sub> 具有两个分量：一个分量 ϕ<sub>11</sub> 仅链接线圈 1；另一个分量 ϕ<sub>12</sub> 链接线圈 1 和线圈 2。因此，

$$
\phi_1 = \phi_{11} + \phi_{12}
$$

尽管两个线圈之间物理上是分开的，但它们被称为磁耦合。由于整个磁通量 ϕ<sub>1</sub> 穿过线圈 1，因此线圈 1 的感应电压 v<sub>1</sub> 可以表示为：

$$
v_1 = N_1 \frac{\mathrm{d}\phi_1}{\mathrm{d}t}
$$

由于只有磁通量 ϕ<sub>12</sub> 穿过线圈 2，因此线圈 2 的感应电压 v<sub>2</sub> 可以表示为：

$$
v_2 = N_2 \frac{\mathrm{d}\phi_{12}}{\mathrm{d}t}
$$

继续，由于线圈 1 的磁通量 ϕ<sub>1</sub> 是由电流 i<sub>1</sub> 产生的，因此 v<sub>1</sub> 还可以表示为：

$$
v_1 = N_1 \frac{\mathrm{d}\phi_1}{\mathrm{d}i_1} \frac{\mathrm{d}i_1}{\mathrm{d}t} = L_1 \frac{\mathrm{d}i_1}{\mathrm{d}t}
$$

其中 $L_1 = N_1 \displaystyle\frac{\mathrm{d}\phi_{1}}{\mathrm{d}i_1}$ 是线圈 1 的自感系数。\
同理，线圈 2 的感应电压 v<sub>2</sub> 还可以表示为：

$$
v_2 = N_2 \frac{\mathrm{d}\phi_{12}}{\mathrm{d}i_1} \frac{\mathrm{d}i_1}{\mathrm{d}t} = M_{21} \frac{\mathrm{d}i_1}{\mathrm{d}t}
$$

其中，

$$
M_{21} = N_2 \frac{\mathrm{d}\phi_{12}}{\mathrm{d}i_1}
$$

被称为线圈 2 关于线圈 1 的**互感系数** (mutual inductance)，其单位为亨利 (H)。\
因此，线圈 2 的开路互感电压 (open-circuit mutual voltage) 为：

$$
\boxed{
v_2 = M_{21} \frac{\mathrm{d}i_1}{\mathrm{d}t}
}
$$

<hr/>

<Img src="/物理学/电磁学/电路基础/fig-13-3.png" alt="Mutual inductance M12 of coil 1 with
respect to coil 2." maxHeight="200px" />

假设现在让电流 i<sub>2</sub> 流过线圈 2，而线圈 1 不带电。从线圈 2 流出的磁通量 ϕ<sub>2</sub> 也有两个分量：一个分量 ϕ<sub>22</sub> 仅链接线圈 2；另一个分量 ϕ<sub>21</sub> 链接线圈 2 和线圈 1。因此，

$$
\phi_2 = \phi_{22} + \phi_{21}
$$

由于整个磁通量 ϕ<sub>2</sub> 穿过线圈 2，因此线圈 2 的感应电压 v<sub>2</sub> 可以表示为：

$$
v_2 = N_2 \frac{\mathrm{d}\phi_2}{\mathrm{d}t} = N_2 \frac{\mathrm{d}\phi_{2}}{\mathrm{d}i_2} \frac{\mathrm{d}i_2}{\mathrm{d}t} = L_2 \frac{\mathrm{d}i_2}{\mathrm{d}t}
$$

由于只有磁通量 ϕ<sub>21</sub> 穿过线圈 1，因此线圈 1 的感应电压 v<sub>1</sub> 可以表示为：

$$
v_1 = N_1 \frac{\mathrm{d}\phi_{21}}{\mathrm{d}t} = N_1 \frac{\mathrm{d}\phi_{21}}{\mathrm{d}i_2} \frac{\mathrm{d}i_2}{\mathrm{d}t} = M_{12} \frac{\mathrm{d}i_2}{\mathrm{d}t}
$$

其中，

$$
M_{12} = N_1 \frac{\mathrm{d}\phi_{21}}{\mathrm{d}i_2}
$$

为线圈 1 关于线圈 2 的互感系数。\
因此，线圈 1 的开路互感电压 (open-circuit mutual voltage) 为：

$$
\boxed{
v_1 = M_{12} \frac{\mathrm{d}i_2}{\mathrm{d}t}
}
$$

<hr/>

**Mutual inductance** is the ability of one inductor to induce a voltage across a neighboring inductor, measured in henrys (H).

### 互感定理

Reciprocity Theorem

The reciprocity theorem states that in a mutual inductance system, **the mutual inductance between two coils is equal** regardless of the direction of current through the coils. This means that if coil A induces a voltage in coil B when current flows through A, then the same current flowing through coil B will induce a voltage in coil A, demonstrating the symmetrical nature of inductive coupling.

$$
M_{12} = M_{21} = M
$$

### 点约定

Dot Convention

<Img src="/物理学/电磁学/电路基础/fig-13-4.png" alt="Illustration of the dot convention."/>

If a current **enters** the dotted terminal of one coil, the reference polarity of the mutual voltage in the second coil is **positive** at the dotted terminal of the second coil.

Alternatively,

If a current **leaves** the dotted terminal of one coil, the reference polarity of the mutual voltage in the second coil is **negative** at the dotted terminal of the second coil.

<Img src="/物理学/电磁学/电路基础/fig-13-5.png" alt="Examples illustrating how to apply the dot convention." maxHeight="256px" />

<Img src="/物理学/电磁学/电路基础/fig-13-6.png" alt="Dot convention for coils in series; the sign indicates the polarity of the mutual voltage: (a) series-aiding connection, (b) series-opposing connection." maxHeight="256px" />

- Series-aiding connection:

$$
L = L_1 + L_2 + 2M
$$

- Series-opposing connection:

$$
L = L_1 + L_2 - 2M
$$

一个单独电感器的总电感 L 的真正构成是所有单匝的自感之和，再加上所有匝间互感的总和：

$$
L = \sum_{i=1}^{N} L_i + 2 \sum_{i=1}^{N-1} \sum_{j=i+1}^{N} M_{ij}
$$

## 耦合电路中的能量

Energy in a Coupled Circuits

<Img src="/物理学/电磁学/电路基础/fig-13-14.png" alt="The circuit for deriving energy stored
in a coupled circuit." maxHeight="200px" />

根据大学物理的结论，单独一个电感所能储存的最大能量为 $w = \frac{1}{2} L i^2$。

考虑如图所示的情况。假设电流 i<sub>1</sub> 和 i<sub>2</sub> 最初都为零，所以两个线圈中的能量也均为零。接下来，让电流 i<sub>1</sub> 从零开始增加到 I<sub>1</sub>，同时电流 i<sub>2</sub> 保持为零。此时，线圈 1 中的瞬时功率为：

$$
p_1(t) = v_1 i_1 = i_1 L_1 \frac{\mathrm{d}i_1}{\mathrm{d}t}
$$

因此线圈 1 中的储存能量为：

$$
w_1 = \int p_1 \mathrm{d}t = L_1 \int_0^{I_1} i_1 \mathrm{d}i_1 = \frac{1}{2} L_1 I_1^2
$$

如果我们保持电流 i<sub>1</sub> 为 I<sub>1</sub>，而让电流 i<sub>2</sub> 从零开始增加到 I<sub>2</sub>，这个阶段下，两个线圈中的瞬时功率为：

$$
p_2(t) = i_1 M_{12} \frac{\mathrm{d}i_2}{\mathrm{d}t} + i_2 v_2 = I_1 M_{12} \frac{\mathrm{d}i_2}{\mathrm{d}t} + i_2 L_2 \frac{\mathrm{d}i_2}{\mathrm{d}t}
$$

阶段 2 的储存能量为：

$$
\begin{aligned}
w_2 
= \int p_2 \mathrm{d}t &= M_{12} I_1 \int_0^{I_2} \mathrm{d}i_2 + L_2 \int_0^{I_2} i_2 \mathrm{d}i_2 \\[8pt]
&= M_{12} I_1 I_2 + \frac{1}{2} L_2 I_2^2
\end{aligned}
$$

把两个阶段的储存能量相加，得到总储存能量为：

$$
w = w_1 + w_2 = \frac{1}{2} L_1 I_1^2 + \frac{1}{2} L_2 I_2^2 + M_{12} I_1 I_2
$$

如果反转电流达到最终值得顺序。即，先将电流 i<sub>2</sub> 从零增加到 I<sub>2</sub>，然后保持为 I<sub>2</sub>，再让电流 i<sub>1</sub> 从零增加到 I<sub>1</sub>，此时总储存能量为：

$$
w = \frac{1}{2} L_1 I_1^2 + \frac{1}{2} L_2 I_2^2 + M_{21} I_1 I_2
$$

无论到达最终值的顺序如何，总储存能量都应该是相同的。因此，可以得出结论：

$$
M_{12} = M_{21} = M
$$

所以

$$
w = \frac{1}{2} L_1 I_1^2 + \frac{1}{2} L_2 I_2^2 + M I_1 I_2
$$

上述表达式是基于两个线圈的电流同时流入各自的打点端 (dotted terminal)。如果一个电流进入一个打点端，而另一个电流流出另一个打点端，那么互感电压为负，因此互感能量 M I<sub>1</sub> I<sub>2</sub> 这一项也为负。在这种情况下：

$$
w = \frac{1}{2} L_1 I_1^2 + \frac{1}{2} L_2 I_2^2 - M I_1 I_2
$$

另外，因为 I<sub>1</sub> 和 I<sub>2</sub> 是任意的，所以电路中存储的瞬时能量具有一般表达形式：

$$
\boxed{
w = \frac{1}{2} L_1 i_1^2 + \frac{1}{2} L_2 i_2^2 \pm M i_1 i_2
}
$$

如果两个电流都同时流入或同时流出打点端，则选择互感项为正；否则选择互感项为负。

因为任何被动电路在任何时刻的总储存能量 w<sub>total</sub> 必须始终大于等于零，所以有：

$$
\begin{aligned}
\frac{1}{2} L_1 i_1^2 + \frac{1}{2} L_2 i_2^2 - M i_1 i_2 &\geq 0 \\[8pt]
\left(\frac{1}{2} L_1 i_1^2 - i_1 i_2 \sqrt{L_1 L_2} + \frac{1}{2} L_2 i_2^2\right) + \left(i_1 i_2 \sqrt{L_1 L_2} - M i_1 i_2\right) &\geq 0 \\[8pt]
\frac{1}{2} \left(i_1 \sqrt{L_1} - i_2 \sqrt{L_2}\right)^2 + i_1 i_2 \left(\sqrt{L_1 L_2} - M\right) &\geq 0 \\[8pt]
\sqrt{L_1 L_2} - M &\geq 0 \\[8pt]
M &\leq \sqrt{L_1 L_2}
\end{aligned}
$$

因此，互感系数 M 的最大值为 &#8730;(L<sub>1</sub> L<sub>2</sub>)，即互感系数不能超过两个线圈自感系数乘积的平方根（即几何平均数）。互感 M 接近上限的程度通常用耦合系数 k 来衡量，其定义如下：

$$
k = \frac{M}{\sqrt{L_1 L_2}}
$$

或者

$$
\boxed{
M = k \sqrt{L_1 L_2}
}
$$

- k = 0
  - 无耦合。$L_1$ 产生的磁通量完全不穿过 $L_2$，反之亦然。它们是完全独立的电感。
- k = 1
  - 完全耦合。这是理论上的最大值。
  - $L_1$ 产生的磁通量完全穿过 $L_2$，反之亦然。没有任何磁通量泄露。
  - 这是理想变压器的假设。
- 0 < k < 1
  - 部分耦合。这是所有现实世界中的情况。
  - $L_1$ 产生的磁通量部分穿过 $L_2$ (这部分贡献了 $M$)，反之亦然。有磁通量泄露。

## 线性变压器

Linear Transformer

A **transformer** is generally a four-terminal device comprising two (or more) magnetically coupled coils.

### 输入阻抗和反射阻抗

<Img src="/物理学/电磁学/电路基础/fig-13-19.png" alt="A linear transformer." maxHeight="200px" />

考虑求出从电源看到的输入阻抗 Z<sub>in</sub>，因为它决定了主电路的行为。对上图所示的左右两个网孔应用 KVL 得到：

$$
\begin{aligned}
\mathbf{V} &= (R_1 + j \omega L_1) \mathbf{I}_1 - j \omega M \mathbf{I}_2\\[8pt]
0 &= - j \omega M \mathbf{I}_1 + (R_2 + j \omega L_2 + \mathbf{Z}_L) \mathbf{I}_2
\end{aligned}
$$

最终可以得到：

$$
\mathbf{Z}_\mathrm{in} = \frac{\mathbf{V}}{\mathbf{I}_1} = R_1 + j \omega L_1 + \frac{\omega^2 M^2}{R_2 + j \omega L_2 + \mathbf{Z}_L}
$$

其中，第三项

$$
\boxed{
\mathbf{Z}_R = \frac{\omega^2 M^2}{R_2 + j \omega L_2 + \mathbf{Z}_L}
}
$$

被称作**反射阻抗** (reflected impedance)。其是由主绕组和副绕组之间的互感引起的。

注意，反射阻抗的结果不受变压器上打点位置的影响，因为当 M 被替换为 -M 时，会产生相同的结果。

### 原始电路

<Img src="/物理学/电磁学/电路基础/fig-13-21.png" alt="Determining the equivalent circuit of a linear transformer." maxHeight="200px" />

如上图所示，对左右两个网孔应用 KVL 得到：

$$
\begin{bmatrix}
\mathbf{V}_1 \\[10pt] \mathbf{V}_2
\end{bmatrix}
=
\begin{bmatrix}
j \omega L_1 & j \omega M\\[10pt]
j \omega M & j \omega L_2
\end{bmatrix}
\begin{bmatrix}
\mathbf{I}_1 \\[10pt] \mathbf{I}_2
\end{bmatrix}
$$

对矩阵进行求逆，得到：

$$
\begin{bmatrix}
\mathbf{I}_1 \\[10pt]
\mathbf{I}_2
\end{bmatrix}
=
\begin{bmatrix}
\displaystyle\frac{L_2}{j \omega (L_1 L_2 - M^2)} & \displaystyle\frac{-M}{j \omega (L_1 L_2 - M^2)}\\[10pt]
\displaystyle\frac{-M}{j \omega (L_1 L_2 - M^2)} & \displaystyle\frac{L_1}{j \omega (L_1 L_2 - M^2)}
\end{bmatrix}
\begin{bmatrix}
\mathbf{V}_1 \\[10pt]
\mathbf{V}_2
\end{bmatrix}
$$

使用 mathematica 求逆矩阵：

<Img src="/物理学/电磁学/电路基础/invMatrix.png" alt="使用 mathematica 求逆矩阵" maxHeight="200px" />

> 接下来的内容中，在推导磁耦合电路的等效电路时，将采用**待定系数法**进行分析。

### 等效 T 电路

<Img src="/物理学/电磁学/电路基础/fig-13-22.png" alt="An equivalent T circuit." maxHeight="150px" />

对等效 T 电路应用 KVL 得到：

$$
\begin{bmatrix}
\mathbf{V}_1 \\[10pt]
\mathbf{V}_2
\end{bmatrix}
=
\begin{bmatrix}
j \omega (L_a + L_c) & j \omega L_c \\[10pt]
j \omega L_c & j \omega (L_b + L_c)
\end{bmatrix}
\begin{bmatrix}
\mathbf{I}_1 \\[10pt]
\mathbf{I}_2
\end{bmatrix}
$$

利用待定系数法，可以得到：

$$
\boxed{
L_a = L_1 - M, \quad L_b = L_2 - M, \quad L_c = M
}
$$

### 等效 Π 电路

<Img src="/物理学/电磁学/电路基础/fig-13-23.png" alt="An equivalent Π circuit." maxHeight="150px" />

对等效 Π 电路应用 KCL 得到：

$$
\begin{bmatrix}
\mathbf{I}_1 \\[10pt]
\mathbf{I}_2
\end{bmatrix}
=
\begin{bmatrix}
\displaystyle\frac{1}{j \omega L_A} + \displaystyle\frac{1}{j \omega L_C} & -\displaystyle\frac{1}{j \omega L_C}\\[10pt]
-\displaystyle\frac{1}{j \omega L_C} & \displaystyle\frac{1}{j \omega L_B} + \displaystyle\frac{1}{j \omega L_C}
\end{bmatrix}
\begin{bmatrix}
\mathbf{V}_1 \\[10pt]
\mathbf{V}_2
\end{bmatrix}
$$

利用待定系数法，可以得到：

$$
\boxed{
L_A = \displaystyle\frac{L_1 L_2 - M^2}{L_2 - M}, \quad L_B = \displaystyle\frac{L_1 L_2 - M^2}{L_1 - M}, \quad L_C = \displaystyle\frac{L_1 L_2 - M^2}{M}
}
$$

> 注：在上述两种等效电路中，各电感器之间不存在互感作用。需要注意的是，互感系数 M 取负值在物理上并无实际意义，但从数学角度来看，等效模型依然成立。

## 理想变压器

Ideal Transformers

$$
\begin{aligned}
\mathbf{V}_1 &= j \omega L_1 \mathbf{I}_1 + j \omega M \mathbf{I}_2\\[8pt]
\mathbf{V}_2 &= j \omega M \mathbf{I}_1 + j \omega L_2 \mathbf{I}_2
\end{aligned}
$$

$$
\mathbf{I_1} = \frac{\mathbf{V}_1 - j \omega M \mathbf{I}_2}{j \omega L_1}
$$

$$
\mathbf{V}_2 = j \omega L_2 \mathbf{I}_2 + \frac{M \mathbf{V}_1}{L_1} - \frac{j \omega M^2 \mathbf{I}_2}{L_1}
$$

$M = k \sqrt{L_1 L_2}$

$$
\mathbf{V}_2 = j \omega L_2 \mathbf{I}_2 + \frac{\sqrt{L_1 L_2} \mathbf{V}_1}{L_1} - \frac{j \omega L_1 L_2 \mathbf{I}_2}{L_1} = \sqrt{\frac{L_2}{L_1}} \mathbf{V}_1 = n \mathbf{V}_1
$$

其中，$n = \sqrt{\displaystyle\frac{L_2}{L_1}}$ 被称为**匝数比** (turns ratio)。

1. Coils have very large reactances (L<sub>1</sub>, L<sub>2</sub>, M &rightarrow; &infin;).
2. Coupling coefficient is equal to unity (k = 1).
3. Primary and secondary coils are lossless (R<sub>1</sub> = 0 = R<sub>2</sub>).
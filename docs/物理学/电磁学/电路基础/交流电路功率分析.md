# 交流电路功率分析

## 瞬时功率

Instantaneous Power

The **instantaneous power** (in watts) is the power at any instant of time.

$$
p(t) = v(t) i(t)
$$

<Img src="/物理学/电磁学/电路基础/fig-11-1.png" alt="Sinusoidal source and passive linear circuit." maxHeight="120px" />

如图，假设电路的电压和电流可以表示为正弦量

$$
\begin{aligned}
v(t) &= V_m \cos(\omega t + \theta_v) \\[8px]
i(t) &= I_m \cos(\omega t - \theta_i)
\end{aligned}
$$

则瞬时功率可以表示为

$$
p(t) = v(t) i(t) = V_m I_m \cos(\omega t + \theta_v) \cos(\omega t - \theta_i)
$$

应用三角函数积化和差公式

$$
\cos A \cos B = \frac{1}{2}\left[ \cos(A + B) + \cos(A - B) \right]
$$

得到

$$
\begin{aligned}
p(t) 
&= \frac{1}{2} V_m I_m \left[ \cos(\omega t + \theta_v + \omega t - \theta_i) + \cos (\omega t + \theta_v - \omega t + \theta_i) \right]\\[8pt]
&= \frac{1}{2} V_m I_m \cos(\theta_v - \theta_i) + \frac{1}{2} V_m I_m \cos(2\omega t + \theta_v + \theta_i)
\end{aligned}
$$

可以看到，瞬时功率的计算公式非常复杂，难以直接计算。

## 平均功率

Average Power

The **average power**, in watts, is the average of the instantaneous power over one period.

$$
P = \frac{1}{T} \int_{0}^{T} p(t) \mathrm{d}t
$$

对瞬时功率公式进行一个周期的积分

$$
\begin{aligned}
P
&= \frac{1}{T} \int_{0}^{T}  \frac{1}{2} V_m I_m \cos(\theta_v - \theta_i)\,\mathrm{d}t + \frac{1}{T} \int_{0}^{T}  \frac{1}{2} V_m I_m \cos(2\omega t + \theta_v + \theta_i)  \,\mathrm{d}t\\[10pt]
&= \frac{1}{2} V_m I_m \cos(\theta_v - \theta_i) \frac{1}{T} \int_{0}^{T} \mathrm{d}t + \underbrace{\frac{1}{T} \int_{0}^{T}  \frac{1}{2} V_m I_m \cos(2\omega t + \theta_v + \theta_i)  \,\mathrm{d}t}_{\text{ 三角函数一个周期的面积为 0}}\\
&= \frac{1}{2} V_m I_m \cos(\theta_v - \theta_i)
\end{aligned}
$$

上式为平均功率的时域表达式。为了获取其相量域表达式，注意到

$$
\begin{aligned}
\frac{1}{2} \mathbf{V} \mathbf{I}^*
&= \frac{1}{2} \cdot V_m e^{j\theta_v} \cdot I_m e^{-j\theta_i}\\[8pt]
&= \frac{1}{2} V_m I_m e^{j(\theta_v - \theta_i)}\\[8pt]
&= \frac{1}{2} V_m I_m [\cos(\theta_v - \theta_i) + \sin(\theta_v - \theta_i)]
\end{aligned}
$$

总结，交流电路平均功率表达式为

<div style="width: fit-content; margin: 0 auto; border: 1px solid #000; padding: 10px;">

$$
P = \mathrm{Re} \left( \frac{1}{2} \mathbf{V} \mathbf{I}^* \right) = \frac{1}{2} V_m I_m \cos(\theta_v - \theta_i)
$$

</div>

## 最大平均功率传输

Maximum Average Power Transfer

For **maximum average power transfer**, the load impedence **Z**<sub>L</sub> must be equal to the complex **conjugate** of the Thevenin impedance **Z**<sub>Th</sub>.

<Img src="/物理学/电磁学/电路基础/fig-11-7.png" alt="Finding the maximum average power transfer: (a) circuit with a load, (b) the Thevenin equivalent." maxHeight="200px" />

如图，假设 **V**<sub>Th</sub> 和 **Z**<sub>Th</sub> 为电路的戴维南等效电压、阻抗值，**Z**<sub>L</sub> 为负载阻抗。并且

$$
\begin{aligned}
\mathbf{Z}_{Th} &= R_{Th} + jX_{Th}\\[8pt]
\mathbf{Z}_{L} &= R_{L} + jX_{L}\\[8pt]
\end{aligned}
$$

流经负载的电流为

$$
\begin{aligned}
\mathbf{I} &= \frac{\mathbf{V}_{Th}}{\mathbf{Z}_{Th} + \mathbf{Z}_{L}}\\[8pt]
&= \frac{\mathbf{V}_{Th}}{R_{Th} + jX_{Th} + R_{L} + jX_{L}}\\[8pt]
&= \frac{\mathbf{V}_{Th}}{(R_{Th} + R_{L}) + j(X_{Th} + X_{L})}
\end{aligned}
$$

传递到负载的平均功率为

$$
\begin{aligned}
P &= \frac{1}{2} V_m I_m \cos 0 = \frac{1}{2} V_m I_m\\[8pt]
&= \frac{1}{2} I_m^2 R_{L} =\frac{1}{2} | \mathbf{I} |^2 R_{L}\\[8pt]
&= \frac{R_L}{2} \frac{| \mathbf{V}_{Th} |^2}{(R_{Th} + R_{L})^2 + (X_{Th} + X_{L})^2} 
\end{aligned}
$$

其中，注意

$$
| \mathbf{I} |^2 = \mathbf{I}\times \mathbf{I}^* = I_m \angle \theta_i \times I_m \angle -\theta_i = I_m^2
$$

以及

$$
\begin{aligned}
| \mathbf{I} | 
&= \frac{| \mathbf{V}_{Th} |}{| (R_{Th} + R_{L}) + j(X_{Th} + X_{L}) |} \\[8pt]
&= \frac{| \mathbf{V}_{Th} |}{\sqrt{(R_{Th} + R_{L})^2 + (X_{Th} + X_{L}) ^2}}\\[8pt]
| \mathbf{I} |^2 &= \frac{| \mathbf{V}_{Th} |^2}{(R_{Th} + R_{L})^2 + (X_{Th} + X_{L}) ^2}
\end{aligned}
$$

为了使负载获得最大平均功率，能够调整的参数只有负载的 R<sub>L</sub> 和 X<sub>L</sub>，所以需要求 P 关于 R<sub>L</sub> 和 X<sub>L</sub> 的偏导数，并令其等于零

先回顾一下乘积求导公式和除法求导公式

$$
\frac{\mathrm{d}}{\mathrm{d}x} (u v) = u^\prime v + u v^\prime
$$

$$
\frac{\mathrm{d}}{\mathrm{d}x} \left( \frac{u}{v} \right) = \frac{u^\prime v - u v^\prime}{v^2}
$$

求 P 关于 R<sub>L</sub> 和 X<sub>L</sub> 的偏导数，并令其等于零

1.

$$
\begin{aligned}
\frac{\partial P}{\partial X_L}
&= \frac{\partial}{\partial X_L}\frac{| \mathbf{V}_{Th} |^2 R_L / 2}{(R_{Th} + R_{L})^2 + (X_{Th} + X_{L}) ^2}\\[8pt]
&= \frac{- | \mathbf{V}_{Th} |^2 R_L / 2\cdot 2(X_{Th} + X_{L})}{\left[ (R_{Th} + R_{L})^2 + (X_{Th} + X_{L}) ^2 \right]^2}\\[8pt]
&= \frac{- | \mathbf{V}_{Th} |^2 R_L (X_{Th} + X_{L})}{\left[ (R_{Th} + R_{L})^2 + (X_{Th} + X_{L}) ^2 \right]^2}\\[8pt]
&= 0\\[8pt]
\text{Thus,}\quad X_{Th} + X_{L} &= 0 \quad \implies \quad X_{L} = -X_{Th}
\end{aligned}
$$

<br>

2.

$$
\begin{aligned}
\frac{\partial P}{\partial R_L}
&= \frac{\partial}{\partial R_L}\frac{| \mathbf{V}_{Th} |^2 R_L / 2}{(R_{Th} + R_{L})^2 + (X_{Th} + X_{L}) ^2}\\[8pt]
&=\frac{| \mathbf{V}_{Th} |^2/2 \cdot [(R_{Th} + R_{L})^2 + (X_{Th} + X_{L})^2] - | \mathbf{V}_{Th} |^2 R_L / 2\cdot 2(R_{Th} + R_{L})}{\left[ (R_{Th} + R_{L})^2 + (X_{Th} + X_{L}) ^2 \right]^2}\\[8pt]
&=\frac{| \mathbf{V}_{Th} |^2 / 2 \times \left[ (R_{Th} + R_{L})^2 + (X_{Th} + X_{L})^2 - 2 R_L (R_{Th} + R_{L}) \right]}{\left[ (R_{Th} + R_{L})^2 + (X_{Th} + X_{L}) ^2 \right]^2}\\[8pt]
&=0
\end{aligned}
$$

$$
\begin{aligned}
\text{Thus,}\quad &(R_{Th} + R_{L})^2 + (X_{Th} + X_{L})^2 - 2 R_L (R_{Th} + R_{L}) = 0\\[8pt]
& R_{Th}^2 + 2 R_{Th} R_{L} + R_{L}^2 + (X_{Th} + X_{L})^2 - 2 R_{Th} R_{L} - 2 R_L^2 = 0\\[8pt]
& R_{Th}^2 - R_{L}^2 + (X_{Th} + X_{L})^2 = 0\\[8pt]
& R_{L} = \sqrt{R_{Th}^2 + (X_{Th} + X_{L})^2}
\end{aligned}
$$

结合上述两个偏微分方程的结果，为了实现最大平均功率传输，负载阻抗 **Z**<sub>L</sub> 必须使得 X<sub>L</sub> = -X<sub>Th</sub>，并且 R<sub>L</sub> = R<sub>Th</sub>。

<div style="width: fit-content; margin: 0 auto; border: 1px solid #000; padding: 10px;">

$$
\mathbf{Z}_{L} = R_{L} - jX_{L} = R_{Th} - jX_{Th} = \mathbf{Z}_{Th}^*
$$

</div>

于是，最大平均功率为

<div style="width: fit-content; margin: 0 auto; border: 1px solid #000; padding: 10px;">

$$
\begin{aligned}
P_{max} 
&= \frac{R_{Th}}{2} \frac{| \mathbf{V}_{Th} |^2}{(R_{Th} + R_{Th})^2 + (X_{Th} - X_{Th})^2} \\[8pt]
&= \frac{| \mathbf{V}_{Th} |^2}{8 R_{Th}}
\end{aligned}
$$

</div>

## 有效值或均方根值

Effective or RMS Value

The **effective value** of a periodic current is the dc current that delivers the same average power to a resistor as the periodic current.

$$
P = I_{\text{eff}}^2 R
$$

The **effective value** of a periodic signal is its root mean square (rms) value.

$$
X_{\text{eff}} = X_{\text{rms}} = \sqrt{\frac{1}{T} \int_{0}^{T} x^2\, \mathrm{d}t}
$$

常用公式

$$
\begin{aligned}
P = \frac{1}{2} V_m I_m \cos(\theta_v - \theta_i) &= \frac{V_{\text{rms}}}{\sqrt{2}} \times \frac{I_{\text{rms}}}{\sqrt{2}} \cos(\theta_v - \theta_i) \\[8pt]
&= V_{\text{rms}} I_{\text{rms}} \cos(\theta_v - \theta_i)
\end{aligned}
$$

<br>

$$
P = I_{\text{rms}}^2 R = \frac{V_{\text{rms}}^2}{R}
$$

## 视在功率和功率因数

Apparent Power and Power Factor

$$
\begin{aligned}
P &= \frac{1}{2} V_m I_m \cos(\theta_v - \theta_i) \\[8pt]
&= V_{\text{rms}} I_{\text{rms}} \cos(\theta_v - \theta_i)
\end{aligned}
$$

The **apparent power** (in VA) is the product of the rms values of voltage and current.

<div style="width: fit-content; margin: 0 auto; border: 1px solid #000; padding: 10px;">

$$
S = V_{\text{rms}} I_{\text{rms}}
$$

</div>

The **power factor** is the cosine of the phase difference between voltage and current. It is also the cosine of the angle of the load impedance.

<div style="width: fit-content; margin: 0 auto; border: 1px solid #000; padding: 10px;">

$$
\text{pf} = \frac{P}{S} = \cos(\theta_v - \theta_i)
$$

</div>

## 复功率

Complex Power

**Complex power** (in VA) is the product of the rms voltage phasor and the complex conjugate of the rms current phasor. As a complex quantity, its real part is real power P and its imaginary part is reactive power Q.

<div style="width: full; margin: 0 auto; border: 1px solid #000; padding: 10px;">

- Complex Power

$$
\mathbf{S} = P + jQ = \mathbf{V}_{\text{rms}} \mathbf{I}_{\text{rms}}^* = |\mathbf{V}_{\text{rms}}| |\mathbf{I}_{\text{rms}}| e^{j(\theta_v - \theta_i)}
$$

- Apparent Power

$$
S = |\mathbf{S}| = |\mathbf{V}_{\text{rms}}| |\mathbf{I}_{\text{rms}}| = \sqrt{P^2 + Q^2}\\[10pt]
$$

- Real Power

$$
P = \mathrm{Re} (\mathbf{S}) = S \cos(\theta_v - \theta_i)
$$

- Reactive Power

$$
Q = \mathrm{Im} (\mathbf{S}) = S \sin(\theta_v - \theta_i)
$$

- Power Factor

$$
\text{pf} = \frac{P}{S} = \cos(\theta_v - \theta_i)
$$

</div>

> The complex, real, and reactive powers of the sources equal the respective sums of the complex, real, and reactive powers of the individual loads.

## 功率因数校正

Power Factor Correction

The process of increasing the power factor without altering the voltage or current to the original load is known as **power factor correction**.

<Img src="/物理学/电磁学/电路基础/fig-11-27.png" alt="Power factor correction: (a) original inductive load, (b) inductive load with improved power factor." maxHeight="200px" />

以下分析需要满足电容并联在原感性负载两端，以确保 real power P 不变。

$$
C = \frac{P(\tan \theta_1 - \tan \theta_2)}{\omega V_{\text{rms}}^2}
$$

> 这个公式还没有自己推导，待刷点这章前面几节的题目再回过来推导。
